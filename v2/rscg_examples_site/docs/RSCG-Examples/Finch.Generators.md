---
sidebar_position: 2220
title: 222 - Finch.Generators
description: dapper style generator
slug: /Finch.Generators
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import TOCInline from '@theme/TOCInline';
import SameCategory from '../Categories/_PrimitiveDatabase.mdx';

# Finch.Generators  by Ivan Mazurenko


<TOCInline toc={toc}  />

## NuGet / site data
[![Nuget](https://img.shields.io/nuget/dt/Finch.Generators?label=Finch.Generators)](https://www.nuget.org/packages/Finch.Generators/)
[![GitHub last commit](https://img.shields.io/github/last-commit/ivmazurenko/finch?label=updated)](https://github.com/ivmazurenko/finch)
![GitHub Repo stars](https://img.shields.io/github/stars/ivmazurenko/finch?style=social)

## Details

### Info
:::info

Name: **Finch.Generators**

Package Description

Author: Ivan Mazurenko

NuGet: 
*https://www.nuget.org/packages/Finch.Generators/*   


You can find more details at https://github.com/ivmazurenko/finch

Source: https://github.com/ivmazurenko/finch

:::

### Author
:::note
Ivan Mazurenko 
![Alt text](https://github.com/ivmazurenko.png)
:::

### Original Readme
:::note

# Finch - database mapping extension methods source generator

## Introduction

Finch is c# source generator designed to simplify database interactions by generating concise extension methods for
database queries mappings.

## Getting Started

1. Install the Finch NuGet packages:
    ```bash
    $ dotnet add package Finch.Abstractions
    $ dotnet add package Finch.Generators
    ```
2. Mark the required type with an [attribute](https://github.com/ivmazurenko/Finch/tree/master/Finch.Abstractions) corresponding to your desired database:
   ```c#
   [GenerateSqlserverConnectionExtensions]
   public class TbUser
   {
      public int id \{ get; set; }
      public string name \{ get; set; }
   }
   ```
3. Use the extension method for your type:

   ```c#
   var connection = new SqlConnection(connectionString);
   var items = await connection.QueryAsync<TbUser>("select * from tb_user");
   ```

## Contribution

Contributions to Finch are welcome! If you encounter any issues or have ideas for improvement, feel free to open an
issue or submit a pull request on GitHub.

## License

Finch is licensed under the MIT License.

:::

### About
:::note

dapper style generator


:::

## How to use

### Example (source csproj, source files)

<Tabs>

<TabItem value="csproj" label="CSharp Project">

This is the CSharp Project that references **Finch.Generators**
```xml showLineNumbers {12}
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net9.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Finch.Abstractions" Version="0.0.107" />
    <PackageReference Include="Finch.Generators" Version="0.0.107" />
    <PackageReference Include="Microsoft.Data.SqlClient" Version="6.1.1" />
  </ItemGroup>
	<PropertyGroup>
		<EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
		<CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\GX</CompilerGeneratedFilesOutputPath>
	</PropertyGroup>
</Project>

```

</TabItem>

  <TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\Program.cs" label="Program.cs" >

  This is the use of **Finch.Generators** in *Program.cs*

```csharp showLineNumbers 
// See https://aka.ms/new-console-template for more information
using DB;
using Microsoft.Data.SqlClient;

Console.WriteLine("Hello, World!");
string connectionString="not set";
var connection = new SqlConnection(connectionString);
var items = await connection.QueryAsync<Person>("select * from Person");
```
  </TabItem>

</Tabs>

### Generated Files

Those are taken from $(BaseIntermediateOutputPath)\GX

<Tabs>


<TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\obj\GX\Finch.Generators\Finch.Generators.SqlserverGenerator\SqlserverConnectionExtensions.Query.g.cs" label="SqlserverConnectionExtensions.Query.g.cs" >
```csharp showLineNumbers 
// <auto-generated/>

namespace DB;

public static partial class SqlserverConnectionExtensions
{
    public static global::System.Collections.Generic.List<T> Query<T>(
        this global::Microsoft.Data.SqlClient.SqlConnection connection,
        string sql)
        where T : new()
    {
        connection.Open();

        var items = new global::System.Collections.Generic.List<T>();
        using var command = new global::Microsoft.Data.SqlClient.SqlCommand(sql, connection);
        using var reader = command.ExecuteReader();
        while (reader.Read())
        {
            T item = new T();

            SqlserverObjectMapper.Map(item, reader);
            items.Add(item);
        }
        
        return items;
    }
}
```
  </TabItem>


<TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\obj\GX\Finch.Generators\Finch.Generators.SqlserverGenerator\SqlserverConnectionExtensions.QueryAsync.g.cs" label="SqlserverConnectionExtensions.QueryAsync.g.cs" >
```csharp showLineNumbers 
// <auto-generated/>

namespace DB;

public static partial class SqlserverConnectionExtensions
{
    public static async global::System.Threading.Tasks.Task<global::System.Collections.Generic.List<T>> QueryAsync<T>(
        this global::Microsoft.Data.SqlClient.SqlConnection connection,
        string sql,
        CancellationToken cancellationToken = default)
        where T : new()
    {
        await connection.OpenAsync(cancellationToken);

        var items = new global::System.Collections.Generic.List<T>();
        await using var command = new global::Microsoft.Data.SqlClient.SqlCommand(sql, connection);
        await using var reader = await command.ExecuteReaderAsync(cancellationToken);
        while (await reader.ReadAsync(cancellationToken))
        {
            T item = new T();

            SqlserverObjectMapper.Map(item, reader);
            items.Add(item);
        }
        
        return items;
    }
}
```
  </TabItem>


<TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\obj\GX\Finch.Generators\Finch.Generators.SqlserverGenerator\SqlserverConnectionExtensions.QueryAsyncWithParameter.g.cs" label="SqlserverConnectionExtensions.QueryAsyncWithParameter.g.cs" >
```csharp showLineNumbers 
// <auto-generated/>

namespace DB;

public static partial class SqlserverConnectionExtensions
{
    public static async global::System.Threading.Tasks.Task<global::System.Collections.Generic.List<T>> QueryAsync<T>(
        this global::Microsoft.Data.SqlClient.SqlConnection connection,
        string sql,
        CancellationToken cancellationToken,
        params global::Microsoft.Data.SqlClient.SqlParameter[] parameters)
        where T : new()
    {
        await connection.OpenAsync(cancellationToken);

        var items = new global::System.Collections.Generic.List<T>();
        await using var command = new global::Microsoft.Data.SqlClient.SqlCommand(sql, connection);
        command.Parameters.AddRange(parameters);
        await using var reader = await command.ExecuteReaderAsync(cancellationToken);
        while (await reader.ReadAsync(cancellationToken))
        {
            T item = new T();

            SqlserverObjectMapper.Map(item, reader);
            items.Add(item);
        }
        
        return items;
    }
}
```
  </TabItem>


<TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\obj\GX\Finch.Generators\Finch.Generators.SqlserverGenerator\SqlserverObjectMapper.g.cs" label="SqlserverObjectMapper.g.cs" >
```csharp showLineNumbers 
// <auto-generated/>

using System;
using System.Collections.Generic;

namespace DB;

internal class SqlserverObjectMapper
{
    public static void Map<T>(T item, global::Microsoft.Data.SqlClient.SqlDataReader reader)
    {
        if(typeof(T) == typeof(DB.Person))
        {
            SqlserverPropertyMapper.Map(item as DB.Person, reader);
            return;
        }
    }
}

```
  </TabItem>


<TabItem value="D:\gth\RSCG_Examples\v2\rscg_examples\Finch.Generators\src\DB\obj\GX\Finch.Generators\Finch.Generators.SqlserverGenerator\SqlserverPropertyMapper.Person.g.cs" label="SqlserverPropertyMapper.Person.g.cs" >
```csharp showLineNumbers 
// <auto-generated/>

using System;

namespace DB;

internal partial class SqlserverPropertyMapper
{
    public static void Map(
        DB.Person item,
        global::Microsoft.Data.SqlClient.SqlDataReader reader)
    {
         item.Id = Convert.ToInt32(reader["Id"]);

         item.Name = reader["Name"].ToString();

         item.Age = Convert.ToInt32(reader["Age"]);
    }
}
```
  </TabItem>


</Tabs>

## Useful

### Download Example (.NET  C#)

:::tip

[Download Example project Finch.Generators ](/sources/Finch.Generators.zip)

:::


### Share Finch.Generators 

<ul>
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators&quote=Finch.Generators" title="Share on Facebook" target="_blank">Share on Facebook</a></li>
  <li><a href="https://twitter.com/intent/tweet?source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators&text=Finch.Generators:%20https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators" target="_blank" title="Tweet">Share in Twitter</a></li>
  <li><a href="http://www.reddit.com/submit?url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators&title=Finch.Generators" target="_blank" title="Submit to Reddit">Share on Reddit</a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators&title=Finch.Generators&summary=&source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FFinch.Generators" target="_blank" title="Share on LinkedIn">Share on Linkedin</a></li>
</ul>

https://ignatandrei.github.io/RSCG_Examples/v2/docs/Finch.Generators

aaa
<SameCategory />

