"use strict";(self.webpackChunkrscg_examples=self.webpackChunkrscg_examples||[]).push([[5266],{27348:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>m,default:()=>g,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var a=n(87462),r=(n(67294),n(3905)),i=n(73992),o=n(18679),l=n(68839);const s={sidebar_position:880,title:"88 - Com",description:"Generating Com Declarations",slug:"/Com"},m="Com  by Microsoft",p={unversionedId:"RSCG-Examples/Com",id:"RSCG-Examples/Com",title:"88 - Com",description:"Generating Com Declarations",source:"@site/docs/RSCG-Examples/Com.md",sourceDirName:"RSCG-Examples",slug:"/Com",permalink:"/RSCG_Examples/v2/docs/Com",draft:!1,tags:[],version:"current",sidebarPosition:880,frontMatter:{sidebar_position:880,title:"88 - Com",description:"Generating Com Declarations",slug:"/Com"},sidebar:"tutorialSidebar",previous:{title:"87 - RDG",permalink:"/RSCG_Examples/v2/docs/RDG"},next:{title:"89 - InterceptorTemplate",permalink:"/RSCG_Examples/v2/docs/InterceptorTemplate"}},c={},d=[{value:"Details",id:"details",level:2},{value:"Info",id:"info",level:3},{value:"Original Readme",id:"original-readme",level:3},{value:"About",id:"about",level:3},{value:"How to use",id:"how-to-use",level:2},{value:"Example ( source csproj, source files )",id:"example--source-csproj-source-files-",level:3},{value:"Generated Files",id:"generated-files",level:3},{value:"Usefull",id:"usefull",level:2},{value:"Download Example (.NET  C# )",id:"download-example-net--c-",level:3},{value:"Share Com",id:"share-com",level:3},{value:"In the same category (EnhancementProject)",id:"in-the-same-category-enhancementproject",level:2},{value:"BuildInfo",id:"buildinfo",level:3},{value:"DeeDee",id:"deedee",level:3},{value:"Mediator",id:"mediator",level:3},{value:"RSCG_AMS",id:"rscg_ams",level:3},{value:"RSCG_FunctionsWithDI",id:"rscg_functionswithdi",level:3},{value:"RSCG_TimeBombComment",id:"rscg_timebombcomment",level:3},{value:"SourceGenerator.Helper.CopyCode",id:"sourcegeneratorhelpercopycode",level:3},{value:"ThisAssembly",id:"thisassembly",level:3}],u={toc:d},h="wrapper";function g(e){let{components:t,...s}=e;return(0,r.kt)(h,(0,a.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"com--by-microsoft"},"Com  by Microsoft"),(0,r.kt)(l.Z,{toc:d,mdxType:"TOCInline"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/System.Runtime.InteropServices/"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/nuget/dt/System.Runtime.InteropServices?label=System.Runtime.InteropServices",alt:"Nuget"})),"\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/github/last-commit/dotnet/runtime?label=updated",alt:"GitHub last commit"})),"\n",(0,r.kt)("img",{parentName:"p",src:"https://img.shields.io/github/stars/dotnet/runtime?style=social",alt:"GitHub Repo stars"})),(0,r.kt)("h2",{id:"details"},"Details"),(0,r.kt)("h3",{id:"info"},"Info"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Name: ",(0,r.kt)("strong",{parentName:"p"},"Com")),(0,r.kt)("p",{parentName:"admonition"},"Provides types that support COM interop and platform invoke services."),(0,r.kt)("p",{parentName:"admonition"},"Commonly Used Types:\nSystem.Runtime.InteropServices.GCHandle\nSystem.Runtime.InteropServices.GuidAttribute\nSystem.Runtime.InteropServices.COMException\nSystem.DllNotFoundException\nSystem.Runtime.InteropServices.DllImportAttribute"),(0,r.kt)("p",{parentName:"admonition"},"Author: Microsoft"),(0,r.kt)("p",{parentName:"admonition"},"NuGet:\n",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"https://www.nuget.org/packages/System.Runtime.InteropServices/"},"https://www.nuget.org/packages/System.Runtime.InteropServices/")),"   "),(0,r.kt)("p",{parentName:"admonition"},"You can find more details at ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/dotnet/standard/native-interop/comwrappers-source-generation"},"https://learn.microsoft.com/en-us/dotnet/standard/native-interop/comwrappers-source-generation")),(0,r.kt)("p",{parentName:"admonition"},"Source : ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime"},"https://github.com/dotnet/runtime"))),(0,r.kt)("h3",{id:"original-readme"},"Original Readme"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("h1",{parentName:"admonition",id:"net-runtime"},".NET Runtime"),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("a",{parentName:"p",href:"https://dev.azure.com/dnceng-public/public/_build/latest?definitionId=129&branchName=main"},(0,r.kt)("img",{parentName:"a",src:"https://dev.azure.com/dnceng-public/public/_apis/build/status/dotnet/runtime/runtime?branchName=main",alt:"Build Status"})),"\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime/labels/help%20wanted"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/github/issues/dotnet/runtime/help%20wanted?style=flat-square&color=%232EA043&label=help%20wanted",alt:"Help Wanted"})),"\n",(0,r.kt)("a",{parentName:"p",href:"https://gitter.im/dotnet/runtime"},(0,r.kt)("img",{parentName:"a",src:"https://badges.gitter.im/Join%20Chat.svg",alt:"Gitter"})),"\n",(0,r.kt)("a",{parentName:"p",href:"https://aka.ms/dotnet-discord"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/discord/732297728826277939?style=flat-square&label=Discord&logo=discord&logoColor=white&color=7289DA",alt:"Discord"}))),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#what-is-net"},"What is .NET?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-can-i-contribute"},"How can I contribute?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#reporting-security-issues-and-security-bugs"},"Reporting security issues and security bugs")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#filing-issues"},"Filing issues")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#useful-links"},"Useful Links")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#net-foundation"},".NET Foundation")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#license"},"License"))),(0,r.kt)("p",{parentName:"admonition"},"This repo contains the code to build the .NET runtime, libraries and shared host (",(0,r.kt)("inlineCode",{parentName:"p"},"dotnet"),") installers for\nall supported platforms, as well as the sources to .NET runtime and libraries."),(0,r.kt)("h2",{parentName:"admonition",id:"what-is-net"},"What is .NET?"),(0,r.kt)("p",{parentName:"admonition"},"Official Starting Page: ",(0,r.kt)("a",{parentName:"p",href:"https://dotnet.microsoft.com"},"https://dotnet.microsoft.com")),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/dotnet/core/get-started"},"How to use .NET")," (with VS, VS Code, command-line CLI)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://dotnet.microsoft.com/download"},"Install official releases")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/runtime/docs/project/dogfooding.md"},"Install daily builds")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/dotnet/core"},"Documentation")," (Get Started, Tutorials, Porting from .NET Framework, API reference, ...)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/dotnet/core/deploying"},"Deploying apps")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/core/blob/main/os-lifecycle-policy.md"},"Supported OS versions")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/core/blob/main/roadmap.md"},"Roadmap")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/core/tree/main/release-notes"},"Releases"))),(0,r.kt)("h2",{parentName:"admonition",id:"how-can-i-contribute"},"How can I contribute?"),(0,r.kt)("p",{parentName:"admonition"},"We welcome contributions! Many people all over the world have helped make this project better."),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/runtime/CONTRIBUTING.md"},"Contributing")," explains what kinds of contributions we welcome"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/runtime/docs/workflow/README.md"},"Workflow Instructions")," explains how to build and test"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/runtime/docs/project/dogfooding.md"},"Get Up and Running on .NET Core")," explains how to get nightly builds of the runtime and its libraries to test them in your own projects.")),(0,r.kt)("h2",{parentName:"admonition",id:"reporting-security-issues-and-security-bugs"},"Reporting security issues and security bugs"),(0,r.kt)("p",{parentName:"admonition"},"Security issues and bugs should be reported privately, via email, to the Microsoft Security Response Center (MSRC) ",(0,r.kt)("a",{parentName:"p",href:"mailto:secure@microsoft.com"},"secure@microsoft.com"),". You should receive a response within 24 hours. If for some reason you do not, please follow up via email to ensure we received your original message. Further information, including the MSRC PGP key, can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://www.microsoft.com/msrc/faqs-report-an-issue"},"Security TechCenter"),". You can also find these instructions in this repo's ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime/SECURITY.md"},"Security doc"),"."),(0,r.kt)("p",{parentName:"admonition"},"Also see info about related ",(0,r.kt)("a",{parentName:"p",href:"https://www.microsoft.com/msrc/bounty-dot-net-core"},"Microsoft .NET Core and ASP.NET Core Bug Bounty Program"),"."),(0,r.kt)("h2",{parentName:"admonition",id:"filing-issues"},"Filing issues"),(0,r.kt)("p",{parentName:"admonition"},"This repo should contain issues that are tied to the runtime, the class libraries and frameworks, the installation of the ",(0,r.kt)("inlineCode",{parentName:"p"},"dotnet")," binary (sometimes known as the ",(0,r.kt)("inlineCode",{parentName:"p"},"muxer"),") and the installation of the .NET runtime and libraries."),(0,r.kt)("p",{parentName:"admonition"},"For other issues, please file them to their appropriate sibling repos. We have links to many of them on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime/issues/new/choose"},"our new issue page"),"."),(0,r.kt)("h2",{parentName:"admonition",id:"useful-links"},"Useful Links"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://source.dot.net"},".NET Core source index")," / ",(0,r.kt)("a",{parentName:"li",href:"https://referencesource.microsoft.com"},".NET Framework source index")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/dotnet/api"},"API Reference docs")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://apisof.net"},".NET API Catalog")," (incl. APIs from daily builds and API usage info)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dotnet/dotnet-api-docs/wiki"},"API docs writing guidelines")," - useful when writing /// comments"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://aka.ms/dotnet-discord"},".NET Discord Server")," - a place to discuss the development of .NET and its ecosystem")),(0,r.kt)("h2",{parentName:"admonition",id:"net-foundation"},".NET Foundation"),(0,r.kt)("p",{parentName:"admonition"},".NET Runtime is a ",(0,r.kt)("a",{parentName:"p",href:"https://www.dotnetfoundation.org/projects"},".NET Foundation")," project."),(0,r.kt)("p",{parentName:"admonition"},"There are many .NET related projects on GitHub."),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/Microsoft/dotnet"},".NET home repo"),"\xa0- links to 100s of .NET projects, from Microsoft and the community."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/aspnet/core"},"ASP.NET Core home")," - the best place to start learning about ASP.NET Core.")),(0,r.kt)("p",{parentName:"admonition"},"This project has adopted the code of conduct defined by the ",(0,r.kt)("a",{parentName:"p",href:"https://contributor-covenant.org"},"Contributor Covenant")," to clarify expected behavior in our community. For more information, see the ",(0,r.kt)("a",{parentName:"p",href:"https://www.dotnetfoundation.org/code-of-conduct"},".NET Foundation Code of Conduct"),"."),(0,r.kt)("p",{parentName:"admonition"},"General .NET OSS discussions: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet-foundation/Home/discussions"},".NET Foundation Discussions")),(0,r.kt)("h2",{parentName:"admonition",id:"license"},"License"),(0,r.kt)("p",{parentName:"admonition"},".NET (including the runtime repo) is licensed under the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dotnet/runtime/LICENSE.TXT"},"MIT")," license.")),(0,r.kt)("h3",{id:"about"},"About"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Generating Com Declarations")),(0,r.kt)("h2",{id:"how-to-use"},"How to use"),(0,r.kt)("h3",{id:"example--source-csproj-source-files-"},"Example ( source csproj, source files )"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"csproj",label:"CSharp Project",mdxType:"TabItem"},(0,r.kt)("p",null,"This is the CSharp Project that references ",(0,r.kt)("strong",{parentName:"p"},"Com")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:"showLineNumbers {10}",showLineNumbers:!0,"{10}":!0},'<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net8.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n      <AllowUnsafeBlocks>true</AllowUnsafeBlocks>\n\x3c!--\n<PackageReference Include="System.Runtime.InteropServices" />\n--\x3e\n  </PropertyGroup>\n    <PropertyGroup>\n        <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>\n        <CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\\GX</CompilerGeneratedFilesOutputPath>\n    </PropertyGroup>\n</Project>\n\n'))),(0,r.kt)(o.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\COM\\src\\ComDemo\\Program.cs",label:"Program.cs",mdxType:"TabItem"},(0,r.kt)("p",null,"  This is the use of ",(0,r.kt)("strong",{parentName:"p"},"Com")," in ",(0,r.kt)("em",{parentName:"p"},"Program.cs")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},'using test;\n\nIShellExecute shellExecute = new ShellExecuteClass();\n\n// Open a file using the default associated program\nIntPtr result = shellExecute.ShellExecute(\n    IntPtr.Zero, // HWND (handle to parent window)\n    "open",      // Operation to perform\n    "notepad.exe", // File to open (replace with your file or URL)\n    "",           // Parameters\n    "",           // Working directory\n    1            // Show command (SW_SHOWNORMAL)\n);\n\nConsole.WriteLine($"ShellExecute Result: {result}");\n\n'))),(0,r.kt)(o.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\COM\\src\\ComDemo\\MyShell.cs",label:"MyShell.cs",mdxType:"TabItem"},(0,r.kt)("p",null,"  This is the use of ",(0,r.kt)("strong",{parentName:"p"},"Com")," in ",(0,r.kt)("em",{parentName:"p"},"MyShell.cs")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},'using System;\nusing System.Runtime.InteropServices;\nusing System.Runtime.InteropServices.Marshalling;\n\nnamespace test;\n\n// Import the ShellExecute function from Shell32.dll using ComImport\n[ComImport]\n[Guid("00000000-0000-0000-C000-000000000046")]\n[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\npublic interface IUnknown\n{\n    void QueryInterface(ref Guid riid, out IntPtr ppvObject);\n    void AddRef();\n    void Release();\n}\n\n//[ComImport]\n[GeneratedComInterface(StringMarshalling = StringMarshalling.Utf8)]\n[Guid("000214F9-0000-0000-C000-000000000046")]\n[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\npublic partial interface IShellExecute\n{\n    IntPtr ShellExecute(IntPtr hwnd, string lpOperation, string lpFile, string lpParameters, string lpDirectory, int nShowCmd);\n}\n\n\n// Replace this with your actual ShellExecute COM class\npublic class ShellExecuteClass : IShellExecute\n{\n    public IntPtr ShellExecute(IntPtr hwnd, string lpOperation, string lpFile, string lpParameters, string lpDirectory, int nShowCmd)\n    {\n        // Implement the ShellExecute functionality\n        return NativeMethods.ShellExecute(hwnd, lpOperation, lpFile, lpParameters, lpDirectory, nShowCmd);\n    }\n}\n\n// NativeMethods class to import necessary functions from Shell32.dll\nstatic class NativeMethods\n{\n    [DllImport("shell32.dll", CharSet = CharSet.Unicode, SetLastError = true)]\n    public static extern IntPtr ShellExecute(\n        IntPtr hwnd,\n        string lpOperation,\n        string lpFile,\n        string lpParameters,\n        string lpDirectory,\n        int nShowCmd\n    );\n}\n\n')))),(0,r.kt)("h3",{id:"generated-files"},"Generated Files"),(0,r.kt)("p",null,"Those are taken from $(BaseIntermediateOutputPath)\\GX"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\COM\\src\\ComDemo\\obj\\GX\\Microsoft.Interop.ComInterfaceGenerator\\Microsoft.Interop.ComInterfaceGenerator\\test.IShellExecute.cs",label:"test.IShellExecute.cs",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},'// <auto-generated />\n#pragma warning disable CS0612, CS0618\nfile unsafe class InterfaceInformation : global::System.Runtime.InteropServices.Marshalling.IIUnknownInterfaceType\n{\n    public static global::System.Guid Iid { get; } = new(new global::System.ReadOnlySpan<byte>(new byte[] { 249, 20, 2, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 70 }));\n\n    private static void** _vtable;\n    public static void** ManagedVirtualMethodTable => _vtable != null ? _vtable : (_vtable = InterfaceImplementation.CreateManagedVirtualFunctionTable());\n}\n\n[global::System.Runtime.InteropServices.DynamicInterfaceCastableImplementationAttribute]\nfile unsafe partial interface InterfaceImplementation : global::test.IShellExecute\n{\n    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.Interop.ComInterfaceGenerator", "8.0.9.8001")]\n    [global::System.Runtime.CompilerServices.SkipLocalsInitAttribute]\n    nint global::test.IShellExecute.ShellExecute(nint hwnd, string lpOperation, string lpFile, string lpParameters, string lpDirectory, int nShowCmd)\n    {\n        var(__this, __vtable_native) = ((global::System.Runtime.InteropServices.Marshalling.IUnmanagedVirtualMethodTableProvider)this).GetVirtualMethodTableInfoForKey(typeof(global::test.IShellExecute));\n        byte* __lpOperation_native = default;\n        byte* __lpFile_native = default;\n        byte* __lpParameters_native = default;\n        byte* __lpDirectory_native = default;\n        nint __retVal = default;\n        int __invokeRetVal = default;\n        // Setup - Perform required setup.\n        scoped global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn __lpDirectory_native__marshaller = new();\n        scoped global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn __lpParameters_native__marshaller = new();\n        scoped global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn __lpFile_native__marshaller = new();\n        scoped global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn __lpOperation_native__marshaller = new();\n        try\n        {\n            // Marshal - Convert managed data to native data.\n            __lpDirectory_native__marshaller.FromManaged(lpDirectory, stackalloc byte[global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn.BufferSize]);\n            __lpParameters_native__marshaller.FromManaged(lpParameters, stackalloc byte[global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn.BufferSize]);\n            __lpFile_native__marshaller.FromManaged(lpFile, stackalloc byte[global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn.BufferSize]);\n            __lpOperation_native__marshaller.FromManaged(lpOperation, stackalloc byte[global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ManagedToUnmanagedIn.BufferSize]);\n            {\n                // PinnedMarshal - Convert managed data to native data that requires the managed data to be pinned.\n                __lpDirectory_native = __lpDirectory_native__marshaller.ToUnmanaged();\n                __lpParameters_native = __lpParameters_native__marshaller.ToUnmanaged();\n                __lpFile_native = __lpFile_native__marshaller.ToUnmanaged();\n                __lpOperation_native = __lpOperation_native__marshaller.ToUnmanaged();\n                __invokeRetVal = ((delegate* unmanaged[MemberFunction]<void*, nint, byte*, byte*, byte*, byte*, int, nint*, int> )__vtable_native[3])(__this, hwnd, __lpOperation_native, __lpFile_native, __lpParameters_native, __lpDirectory_native, nShowCmd, &__retVal);\n            }\n\n            // NotifyForSuccessfulInvoke - Keep alive any managed objects that need to stay alive across the call.\n            global::System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(__invokeRetVal);\n            global::System.GC.KeepAlive(this);\n        }\n        finally\n        {\n            // CleanupCallerAllocated - Perform cleanup of caller allocated resources.\n            __lpDirectory_native__marshaller.Free();\n            __lpParameters_native__marshaller.Free();\n            __lpFile_native__marshaller.Free();\n            __lpOperation_native__marshaller.Free();\n        }\n\n        return __retVal;\n    }\n}\n\nfile unsafe partial interface InterfaceImplementation\n{\n    [global::System.Runtime.InteropServices.UnmanagedCallersOnlyAttribute(CallConvs = new[] { typeof(global::System.Runtime.CompilerServices.CallConvMemberFunction) })]\n    internal static int ABI_ShellExecute(global::System.Runtime.InteropServices.ComWrappers.ComInterfaceDispatch* __this_native, nint hwnd, byte* __lpOperation_native, byte* __lpFile_native, byte* __lpParameters_native, byte* __lpDirectory_native, int nShowCmd, nint* __invokeRetValUnmanaged__param)\n    {\n        global::test.IShellExecute @this = default;\n        string lpOperation = default;\n        string lpFile = default;\n        string lpParameters = default;\n        string lpDirectory = default;\n        ref nint __invokeRetValUnmanaged = ref *__invokeRetValUnmanaged__param;\n        nint __invokeRetVal = default;\n        int __retVal = default;\n        try\n        {\n            // Unmarshal - Convert native data to managed data.\n            lpDirectory = global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ConvertToManaged(__lpDirectory_native);\n            lpParameters = global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ConvertToManaged(__lpParameters_native);\n            lpFile = global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ConvertToManaged(__lpFile_native);\n            lpOperation = global::System.Runtime.InteropServices.Marshalling.Utf8StringMarshaller.ConvertToManaged(__lpOperation_native);\n            @this = global::System.Runtime.InteropServices.ComWrappers.ComInterfaceDispatch.GetInstance<global::test.IShellExecute>(__this_native);\n            __invokeRetVal = @this.ShellExecute(hwnd, lpOperation, lpFile, lpParameters, lpDirectory, nShowCmd);\n            // NotifyForSuccessfulInvoke - Keep alive any managed objects that need to stay alive across the call.\n            __retVal = 0; // S_OK\n            // Marshal - Convert managed data to native data.\n            __invokeRetValUnmanaged = __invokeRetVal;\n        }\n        catch (global::System.Exception __exception)\n        {\n            __retVal = global::System.Runtime.InteropServices.Marshalling.ExceptionAsHResultMarshaller<int>.ConvertToUnmanaged(__exception);\n        }\n\n        return __retVal;\n    }\n}\n\nfile unsafe partial interface InterfaceImplementation\n{\n    internal static void** CreateManagedVirtualFunctionTable()\n    {\n        void** vtable = (void**)global::System.Runtime.CompilerServices.RuntimeHelpers.AllocateTypeAssociatedMemory(typeof(global::test.IShellExecute), sizeof(void*) * 4);\n        {\n            nint v0, v1, v2;\n            global::System.Runtime.InteropServices.ComWrappers.GetIUnknownImpl(out v0, out v1, out v2);\n            vtable[0] = (void*)v0;\n            vtable[1] = (void*)v1;\n            vtable[2] = (void*)v2;\n        }\n\n        {\n            vtable[3] = (void*)(delegate* unmanaged[MemberFunction]<global::System.Runtime.InteropServices.ComWrappers.ComInterfaceDispatch*, nint, byte*, byte*, byte*, byte*, int, nint*, int> )&ABI_ShellExecute;\n        }\n\n        return vtable;\n    }\n}\n\nnamespace test\n{\n    [global::System.Runtime.InteropServices.Marshalling.IUnknownDerivedAttribute<InterfaceInformation, InterfaceImplementation>]\n    public partial interface IShellExecute\n    {\n    }\n}\n\nnamespace test\n{\n    public partial interface IShellExecute\n    {\n    }\n}\n')))),(0,r.kt)("h2",{id:"usefull"},"Usefull"),(0,r.kt)("h3",{id:"download-example-net--c-"},"Download Example (.NET  C# )"),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("a",{target:"_blank",href:n(62210).Z},"Download Example project Com "))),(0,r.kt)("h3",{id:"share-com"},"Share Com"),(0,r.kt)("ul",null,(0,r.kt)("li",null,(0,r.kt)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom&quote=Com",title:"Share on Facebook",target:"_blank"},"Share on Facebook")),(0,r.kt)("li",null,(0,r.kt)("a",{href:"https://twitter.com/intent/tweet?source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom&text=Com:%20https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom",target:"_blank",title:"Tweet"},"Share in Twitter")),(0,r.kt)("li",null,(0,r.kt)("a",{href:"http://www.reddit.com/submit?url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom&title=Com",target:"_blank",title:"Submit to Reddit"},"Share on Reddit")),(0,r.kt)("li",null,(0,r.kt)("a",{href:"http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom&title=Com&summary=&source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCom",target:"_blank",title:"Share on LinkedIn"},"Share on Linkedin"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/Com"},"https://ignatandrei.github.io/RSCG_Examples/v2/docs/Com")),(0,r.kt)("h2",{id:"in-the-same-category-enhancementproject"},"In the same category (EnhancementProject)"),(0,r.kt)("h3",{id:"buildinfo"},(0,r.kt)("a",{parentName:"h3",href:"/docs/BuildInfo"},"BuildInfo")),(0,r.kt)("h3",{id:"deedee"},(0,r.kt)("a",{parentName:"h3",href:"/docs/DeeDee"},"DeeDee")),(0,r.kt)("h3",{id:"mediator"},(0,r.kt)("a",{parentName:"h3",href:"/docs/Mediator"},"Mediator")),(0,r.kt)("h3",{id:"rscg_ams"},(0,r.kt)("a",{parentName:"h3",href:"/docs/RSCG_AMS"},"RSCG_AMS")),(0,r.kt)("h3",{id:"rscg_functionswithdi"},(0,r.kt)("a",{parentName:"h3",href:"/docs/RSCG_FunctionsWithDI"},"RSCG_FunctionsWithDI")),(0,r.kt)("h3",{id:"rscg_timebombcomment"},(0,r.kt)("a",{parentName:"h3",href:"/docs/RSCG_TimeBombComment"},"RSCG_TimeBombComment")),(0,r.kt)("h3",{id:"sourcegeneratorhelpercopycode"},(0,r.kt)("a",{parentName:"h3",href:"/docs/SourceGenerator.Helper.CopyCode"},"SourceGenerator.Helper.CopyCode")),(0,r.kt)("h3",{id:"thisassembly"},(0,r.kt)("a",{parentName:"h3",href:"/docs/ThisAssembly"},"ThisAssembly")))}g.isMDXComponent=!0},62210:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/Com-c359ff4e3e0b18c460a8b7165f771c65.zip"}}]);