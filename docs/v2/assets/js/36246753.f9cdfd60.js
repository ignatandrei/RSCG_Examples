"use strict";(self.webpackChunkrscg_examples=self.webpackChunkrscg_examples||[]).push([[591],{3621:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>g,frontMatter:()=>d,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"RSCG-Examples/spreadcheetah","title":"43 - spreadcheetah","description":"generating Excel from objects","source":"@site/docs/RSCG-Examples/spreadcheetah.md","sourceDirName":"RSCG-Examples","slug":"/spreadcheetah","permalink":"/RSCG_Examples/v2/docs/spreadcheetah","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/RSCG-Examples/spreadcheetah.md","tags":[],"version":"current","sidebarPosition":430,"frontMatter":{"sidebar_position":430,"title":"43 - spreadcheetah","description":"generating Excel from objects","slug":"/spreadcheetah"},"sidebar":"tutorialSidebar","previous":{"title":"42 - Immutype","permalink":"/RSCG_Examples/v2/docs/Immutype"},"next":{"title":"44 - SyncMethodGenerator","permalink":"/RSCG_Examples/v2/docs/SyncMethodGenerator"}}');var n=s(74848),a=s(28453),i=s(11470),l=s(19365),h=s(14252);const d={sidebar_position:430,title:"43 - spreadcheetah",description:"generating Excel from objects",slug:"/spreadcheetah"},o="spreadcheetah  by Sveinung",c={},p=[{value:"NuGet / site data",id:"nuget--site-data",level:2},{value:"Details",id:"details",level:2},{value:"Info",id:"info",level:3},{value:"Original Readme",id:"original-readme",level:3},{value:"Features",id:"features",level:2},{value:"How to install",id:"how-to-install",level:2},{value:"Basic usage",id:"basic-usage",level:2},{value:"Other examples",id:"other-examples",level:3},{value:"Using the Source Generator",id:"using-the-source-generator",level:2},{value:"Benchmarks",id:"benchmarks",level:2},{value:".NET Framework 4.8",id:"net-framework-48",level:3},{value:".NET 6",id:"net-6",level:3},{value:".NET 7",id:"net-7",level:3},{value:"About",id:"about",level:3},{value:"How to use",id:"how-to-use",level:2},{value:"Example ( source csproj, source files )",id:"example--source-csproj-source-files-",level:3},{value:"Generated Files",id:"generated-files",level:3},{value:"Useful",id:"useful",level:2},{value:"Download Example (.NET  C# )",id:"download-example-net--c-",level:3},{value:"Share spreadcheetah",id:"share-spreadcheetah",level:3},{value:"In the same category (Templating) - 11 other generators",id:"in-the-same-category-templating---11-other-generators",level:3},{value:"Gobie",id:"gobie",level:4},{value:"InterceptorTemplate",id:"interceptortemplate",level:4},{value:"JKToolKit.TemplatePropertyGenerator",id:"jktoolkittemplatepropertygenerator",level:4},{value:"Microsoft.NET.Sdk.Razor.SourceGenerators",id:"microsoftnetsdkrazorsourcegenerators",level:4},{value:"Minerals.AutoMixins",id:"mineralsautomixins",level:4},{value:"MorrisMoxy",id:"morrismoxy",level:4},{value:"NTypewriter",id:"ntypewriter",level:4},{value:"RazorBlade",id:"razorblade",level:4},{value:"RazorSlices",id:"razorslices",level:4},{value:"RSCG_IFormattable",id:"rscg_iformattable",level:4},{value:"RSCG_Templating",id:"rscg_templating",level:4}];function x(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"spreadcheetah--by-sveinung",children:"spreadcheetah  by Sveinung"})}),"\n",(0,n.jsx)(h.A,{toc:p}),"\n",(0,n.jsx)(t.h2,{id:"nuget--site-data",children:"NuGet / site data"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://www.nuget.org/packages/spreadcheetah/",children:(0,n.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/spreadcheetah?label=spreadcheetah",alt:"Nuget"})}),"\n",(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah",children:(0,n.jsx)(t.img,{src:"https://img.shields.io/github/last-commit/sveinungf/spreadcheetah?label=updated",alt:"GitHub last commit"})}),"\n",(0,n.jsx)(t.img,{src:"https://img.shields.io/github/stars/sveinungf/spreadcheetah?style=social",alt:"GitHub Repo stars"})]}),"\n",(0,n.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,n.jsx)(t.h3,{id:"info",children:"Info"}),"\n",(0,n.jsxs)(t.admonition,{type:"info",children:[(0,n.jsxs)(t.p,{children:["Name: ",(0,n.jsx)(t.strong,{children:"spreadcheetah"})]}),(0,n.jsx)(t.p,{children:"SpreadCheetah is a high-performance .NET library for generating spreadsheet (Microsoft Excel XLSX) files."}),(0,n.jsx)(t.p,{children:"Author: Sveinung"}),(0,n.jsxs)(t.p,{children:["NuGet:\n",(0,n.jsx)(t.em,{children:(0,n.jsx)(t.a,{href:"https://www.nuget.org/packages/spreadcheetah/",children:"https://www.nuget.org/packages/spreadcheetah/"})})]}),(0,n.jsxs)(t.p,{children:["You can find more details at ",(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah",children:"https://github.com/sveinungf/spreadcheetah"})]}),(0,n.jsxs)(t.p,{children:["Source: ",(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah",children:"https://github.com/sveinungf/spreadcheetah"})]})]}),"\n",(0,n.jsx)(t.h3,{id:"original-readme",children:"Original Readme"}),"\n",(0,n.jsxs)(t.admonition,{type:"note",children:[(0,n.jsx)(t.h1,{id:"spreadcheetah",children:"SpreadCheetah"}),(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://www.nuget.org/packages/SpreadCheetah",children:(0,n.jsx)(t.img,{src:"https://img.shields.io/nuget/v/SpreadCheetah",alt:"Nuget"})})}),(0,n.jsx)(t.p,{children:"SpreadCheetah is a high-performance .NET library for generating spreadsheet (Microsoft Excel XLSX) files."}),(0,n.jsx)(t.h2,{id:"features",children:"Features"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Performance (see benchmarks below)"}),"\n",(0,n.jsx)(t.li,{children:"Low memory allocation (see benchmarks below)"}),"\n",(0,n.jsx)(t.li,{children:"Async APIs"}),"\n",(0,n.jsx)(t.li,{children:"No dependency to Microsoft Excel"}),"\n",(0,n.jsx)(t.li,{children:"Targeting .NET Standard 2.0 (for .NET Framework 4.6.1 and later)"}),"\n",(0,n.jsx)(t.li,{children:"Free and open source!"}),"\n"]}),(0,n.jsx)(t.p,{children:"SpreadCheetah is designed to create spreadsheet files in a forward-only manner.\nThat means worksheets from left to right, rows from top to bottom, and row cells from left to right.\nThis allows for creating spreadsheet files in a streaming manner, while also keeping a low memory footprint."}),(0,n.jsx)(t.p,{children:"Most basic spreadsheet functionality is supported, such as cells with different data types, basic styling, and formulas. More advanced functionality is planned for future releases."}),(0,n.jsx)(t.h2,{id:"how-to-install",children:"How to install"}),(0,n.jsxs)(t.p,{children:["SpreadCheetah is available as a ",(0,n.jsx)(t.a,{href:"https://www.nuget.org/packages/SpreadCheetah",children:"NuGet package"}),". The NuGet package targets .NET Standard 2.0 as well as newer versions of .NET. The .NET Standard 2.0 version is just intended for backwards compatibility (.NET Framework and earlier versions of .NET Core). More optimizations are enabled when targeting newer versions of .NET."]}),(0,n.jsx)(t.h2,{id:"basic-usage",children:"Basic usage"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cs",children:'using (var spreadsheet = await Spreadsheet.CreateNewAsync(stream))\n{\n    // A spreadsheet must contain at least one worksheet.\n    await spreadsheet.StartWorksheetAsync("Sheet 1");\n\n    // Cells are inserted row by row.\n    var row = new List<Cell>();\n    row.Add(new Cell("Answer to the ultimate question:"));\n    row.Add(new Cell(42));\n\n    // Rows are inserted from top to bottom.\n    await spreadsheet.AddRowAsync(row);\n\n    // Remember to call Finish before disposing.\n    // This is important to properly finalize the XLSX file.\n    await spreadsheet.FinishAsync();\n}\n'})}),(0,n.jsx)(t.h3,{id:"other-examples",children:"Other examples"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/WriteToFile.cs",children:"Writing to a file"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/StylingBasics.cs",children:"Styling basics"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/FormulaBasics.cs",children:"Formula basics"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/DateTimeAndFormatting.cs",children:"DateTime and formatting"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/DataValidations.cs",children:"Data Validations"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah-samples/blob/main/SpreadCheetahSamples/PerformanceTips.cs",children:"Performance tips"})}),"\n"]}),(0,n.jsx)(t.h2,{id:"using-the-source-generator",children:"Using the Source Generator"}),(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://devblogs.microsoft.com/dotnet/introducing-c-source-generators",children:"Source Generators"})," is a newly released feature in the C# compiler. SpreadCheetah includes a source generator that makes it easier to create rows from objects. It is used in a similar way to the ",(0,n.jsxs)(t.a,{href:"https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-source-generator/",children:[(0,n.jsx)(t.code,{children:"System.Text.Json"})," source generator"]}),":"]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cs",children:"namespace MyNamespace;\n\n// A plain old C# class which we want to add as a row in a worksheet.\n// The source generator will pick the properties with public getters.\n// The order of the properties will decide the order of the cells.\npublic class MyObject\n{\n    public string Question { get; set; }\n    public int Answer { get; set; }\n}\n"})}),(0,n.jsx)(t.p,{children:"The source generator will be instructed to generate code by defining a partial class like this:"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cs",children:"using SpreadCheetah.SourceGeneration;\n\nnamespace MyNamespace;\n\n[WorksheetRow(typeof(MyObject))]\npublic partial class MyObjectRowContext : WorksheetRowContext\n{\n}\n"})}),(0,n.jsxs)(t.p,{children:["During build, the type will be analyzed and an implementation of the context class will be created. We can then create a row from an object by calling ",(0,n.jsx)(t.code,{children:"AddAsRowAsync"})," with the object and the context type as parameters:"]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cs",children:'await using var spreadsheet = await Spreadsheet.CreateNewAsync(stream);\nawait spreadsheet.StartWorksheetAsync("Sheet 1");\n\nvar myObj = new MyObject { Question = "How many Rings of Power were there?", Answer = 20 };\n\nawait spreadsheet.AddAsRowAsync(myObj, MyObjectRowContext.Default.MyObject);\n\nawait spreadsheet.FinishAsync();\n'})}),(0,n.jsx)(t.p,{children:"Here is a peek at part of the code that was generated for this example:"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cs",children:"// <auto-generated />\nprivate static async ValueTask AddAsRowInternalAsync(Spreadsheet spreadsheet, MyObject obj, CancellationToken token)\n{\n    var cells = ArrayPool<DataCell>.Shared.Rent(2);\n    try\n    {\n        cells[0] = new DataCell(obj.Question);\n        cells[1] = new DataCell(obj.Answer);\n        await spreadsheet.AddRowAsync(cells.AsMemory(0, 2), token).ConfigureAwait(false);\n    }\n    finally\n    {\n        ArrayPool<DataCell>.Shared.Return(cells, true);\n    }\n}\n"})}),(0,n.jsx)(t.p,{children:"The source generator can generate rows from classes, records, and structs. It can be used in all supported .NET versions, including .NET Framework, however the C# version must be 8.0 or greater."}),(0,n.jsx)(t.h2,{id:"benchmarks",children:"Benchmarks"}),(0,n.jsxs)(t.p,{children:["The benchmark results here have been collected using ",(0,n.jsx)(t.a,{href:"https://github.com/dotnet/benchmarkdotnet",children:"Benchmark.NET"})," with the following system configuration:"]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ini",children:"BenchmarkDotNet=v0.13.2, OS=Windows 10 (10.0.19043.2251/21H1/May2021Update)\nIntel Core i5-8600K CPU 3.60GHz (Coffee Lake), 1 CPU, 6 logical and 6 physical cores\n.NET SDK=7.0.100\n  [Host]             : .NET 7.0.0 (7.0.22.51805), X64 RyuJIT AVX2\n  .NET 6.0           : .NET 6.0.11 (6.0.1122.52304), X64 RyuJIT AVX2\n  .NET 7.0           : .NET 7.0.0 (7.0.22.51805), X64 RyuJIT AVX2\n  .NET Framework 4.8 : .NET Framework 4.8 (4.8.4515.0), X64 RyuJIT VectorSize=256\n\nInvocationCount=1  UnrollFactor=1\n"})}),(0,n.jsxs)(t.p,{children:["The code executed in the benchmark creates a worksheet of 20 000 rows and 10 columns filled with string values. The same use case has been implemented in other spreadsheet libraries for comparison.\nSome of these libraries have multiple ways of achieving the same result, but to make this a fair comparison the idea is to use the most efficient approach for each library. The code is available ",(0,n.jsx)(t.a,{href:"https://github.com/sveinungf/spreadcheetah/blob/main/SpreadCheetah.Benchmark/Benchmarks/StringCells.cs",children:"here"}),"."]}),(0,n.jsx)(t.h3,{id:"net-framework-48",children:".NET Framework 4.8"}),(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Library"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Mean"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Error"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"StdDev"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Allocated"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"SpreadCheetah"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"68.67 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.283 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.251 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"152.23 KB"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (SAX approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"438.22 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.161 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.086 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"43 317.24 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EPPlus v4"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"609.98 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"6.626 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"5.874 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"286 142.58 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (DOM approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1,098.52 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"9.419 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"8.811 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"161 123.16 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ClosedXML"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1,618.57 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"7.088 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"6.630 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"565 074.91 KB"})]})]})]}),(0,n.jsx)(t.h3,{id:"net-6",children:".NET 6"}),(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Library"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Mean"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Error"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"StdDev"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Allocated"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"SpreadCheetah"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"28.53 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.079 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.070 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"6.48 KB"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (SAX approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"250.65 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"0.541 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"0.480 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"66 049.91 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EPPlus v4"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"405.90 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.782 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.579 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"195 790.25 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (DOM approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"775.74 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"14.404 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"14.147 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"182 926.06 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ClosedXML"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1,262.92 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"19.825 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"18.544 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"524 913.50 KB"})]})]})]}),(0,n.jsx)(t.h3,{id:"net-7",children:".NET 7"}),(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Library"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Mean"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Error"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"StdDev"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Allocated"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"SpreadCheetah"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"25.14 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.148 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"0.138 ms"})}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:(0,n.jsx)(t.strong,{children:"6.48 KB"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (SAX approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"239.72 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"0.231 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"0.216 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"66 046.48 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EPPlus v4"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"406.69 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.852 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1.642 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"195 792.41 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Open XML (DOM approach)"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"831.68 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"10.446 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"9.771 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"182 926.04 KB"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ClosedXML"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1,171.07 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"8.106 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"7.186 ms"}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"524 846.85 KB"})]})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"about",children:"About"}),"\n",(0,n.jsxs)(t.admonition,{type:"note",children:[(0,n.jsx)(t.p,{children:"generating Excel from objects"}),(0,n.jsx)(t.p,{children:"does not work with DateTime"})]}),"\n",(0,n.jsx)(t.h2,{id:"how-to-use",children:"How to use"}),"\n",(0,n.jsx)(t.h3,{id:"example--source-csproj-source-files-",children:"Example ( source csproj, source files )"}),"\n",(0,n.jsxs)(i.A,{children:[(0,n.jsxs)(l.A,{value:"csproj",label:"CSharp Project",children:[(0,n.jsxs)(t.p,{children:["This is the CSharp Project that references ",(0,n.jsx)(t.strong,{children:"spreadcheetah"})]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-xml",metastring:"showLineNumbers {11}",children:'<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net7.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include="SpreadCheetah" Version="1.10.0" />\n  </ItemGroup>\n\t<PropertyGroup>\n\t\t<EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>\n\t\t<CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\\GX</CompilerGeneratedFilesOutputPath>\n\t</PropertyGroup>\n</Project>\n\n'})})]}),(0,n.jsxs)(l.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\spreadcheetah\\src\\spreadcheetahDemo\\Program.cs",label:"Program.cs",children:[(0,n.jsxs)(t.p,{children:["This is the use of ",(0,n.jsx)(t.strong,{children:"spreadcheetah"})," in ",(0,n.jsx)(t.em,{children:"Program.cs"})]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:'using SpreadCheetah;\nusing spreadcheetahDemo;\n\nusing var stream = File.Create("a.xlsx");\nusing var spreadsheet = await Spreadsheet.CreateNewAsync(stream);\n\n// A spreadsheet must contain at least one worksheet.\nawait spreadsheet.StartWorksheetAsync("Sheet 1");\n\n// Cells are inserted row by row.\nvar row = new List<Cell>();\nrow.Add(new Cell("Answer to the ultimate question:"));\nrow.Add(new Cell(42));\n\n// Rows are inserted from top to bottom.\nawait spreadsheet.AddRowAsync(row);\nvar p=new Person();\np.FirstName = "Andrei";\np.LastName = "Ignat";\nawait spreadsheet.AddAsRowAsync(p, PersonRowContext.Default.Person);\n\n// Remember to call Finish before disposing.\n// This is important to properly finalize the XLSX file.\nawait spreadsheet.FinishAsync();\nConsole.WriteLine("see a.xlsx");\n\n'})})]}),(0,n.jsxs)(l.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\spreadcheetah\\src\\spreadcheetahDemo\\Person.cs",label:"Person.cs",children:[(0,n.jsxs)(t.p,{children:["This is the use of ",(0,n.jsx)(t.strong,{children:"spreadcheetah"})," in ",(0,n.jsx)(t.em,{children:"Person.cs"})]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:"using SpreadCheetah.SourceGeneration;\n\nnamespace spreadcheetahDemo;\n\npublic class Person\n{\n    public string? FirstName { get; set; }\n    public string? LastName { get; set; }\n}\n\n[WorksheetRow(typeof(Person))]\npublic partial class PersonRowContext : WorksheetRowContext\n{\n}\n"})})]})]}),"\n",(0,n.jsx)(t.h3,{id:"generated-files",children:"Generated Files"}),"\n",(0,n.jsx)(t.p,{children:"Those are taken from $(BaseIntermediateOutputPath)\\GX"}),"\n",(0,n.jsx)(i.A,{children:(0,n.jsx)(l.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\spreadcheetah\\src\\spreadcheetahDemo\\obj\\GX\\SpreadCheetah.SourceGenerator\\SpreadCheetah.SourceGenerators.WorksheetRowGenerator\\spreadcheetahDemo.PersonRowContext.g.cs",label:"spreadcheetahDemo.PersonRowContext.g.cs",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:"// <auto-generated />\n#nullable enable\nusing SpreadCheetah;\nusing SpreadCheetah.SourceGeneration;\nusing System;\nusing System.Buffers;\nusing System.Collections.Generic;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nnamespace spreadcheetahDemo\n{\n    public partial class PersonRowContext\n    {\n        private static PersonRowContext? _default;\n        public static PersonRowContext Default => _default ??= new PersonRowContext();\n\n        public PersonRowContext()\n        {\n        }\n\n        private WorksheetRowTypeInfo<spreadcheetahDemo.Person>? _Person;\n        public WorksheetRowTypeInfo<spreadcheetahDemo.Person> Person => _Person ??= WorksheetRowMetadataServices.CreateObjectInfo<spreadcheetahDemo.Person>(AddAsRowAsync, AddRangeAsRowsAsync);\n\n        private static ValueTask AddAsRowAsync(SpreadCheetah.Spreadsheet spreadsheet, spreadcheetahDemo.Person? obj, CancellationToken token)\n        {\n            if (spreadsheet is null)\n                throw new ArgumentNullException(nameof(spreadsheet));\n            if (obj is null)\n                return spreadsheet.AddRowAsync(ReadOnlyMemory<DataCell>.Empty, token);\n            return AddAsRowInternalAsync(spreadsheet, obj, token);\n        }\n\n        private static ValueTask AddRangeAsRowsAsync(SpreadCheetah.Spreadsheet spreadsheet, IEnumerable<spreadcheetahDemo.Person?> objs, CancellationToken token)\n        {\n            if (spreadsheet is null)\n                throw new ArgumentNullException(nameof(spreadsheet));\n            if (objs is null)\n                throw new ArgumentNullException(nameof(objs));\n            return AddRangeAsRowsInternalAsync(spreadsheet, objs, token);\n        }\n\n        private static async ValueTask AddAsRowInternalAsync(SpreadCheetah.Spreadsheet spreadsheet, spreadcheetahDemo.Person obj, CancellationToken token)\n        {\n            var cells = ArrayPool<DataCell>.Shared.Rent(2);\n            try\n            {\n                await AddCellsAsRowAsync(spreadsheet, obj, cells, token).ConfigureAwait(false);\n            }\n            finally\n            {\n                ArrayPool<DataCell>.Shared.Return(cells, true);\n            }\n        }\n\n        private static async ValueTask AddRangeAsRowsInternalAsync(SpreadCheetah.Spreadsheet spreadsheet, IEnumerable<spreadcheetahDemo.Person?> objs, CancellationToken token)\n        {\n            var cells = ArrayPool<DataCell>.Shared.Rent(2);\n            try\n            {\n                await AddEnumerableAsRowsAsync(spreadsheet, objs, cells, token).ConfigureAwait(false);\n            }\n            finally\n            {\n                ArrayPool<DataCell>.Shared.Return(cells, true);\n            }\n        }\n\n        private static async ValueTask AddEnumerableAsRowsAsync(SpreadCheetah.Spreadsheet spreadsheet, IEnumerable<spreadcheetahDemo.Person?> objs, DataCell[] cells, CancellationToken token)\n        {\n            foreach (var obj in objs)\n            {\n                await AddCellsAsRowAsync(spreadsheet, obj, cells, token).ConfigureAwait(false);\n            }\n        }\n\n        private static ValueTask AddCellsAsRowAsync(SpreadCheetah.Spreadsheet spreadsheet, spreadcheetahDemo.Person? obj, DataCell[] cells, CancellationToken token)\n        {\n            if (obj is null)\n                return spreadsheet.AddRowAsync(ReadOnlyMemory<DataCell>.Empty, token);\n\n            cells[0] = new DataCell(obj.FirstName);\n            cells[1] = new DataCell(obj.LastName);\n            return spreadsheet.AddRowAsync(cells.AsMemory(0, 2), token);\n        }\n    }\n}\n\n"})})})}),"\n",(0,n.jsx)(t.h2,{id:"useful",children:"Useful"}),"\n",(0,n.jsx)(t.h3,{id:"download-example-net--c-",children:"Download Example (.NET  C# )"}),"\n",(0,n.jsx)(t.admonition,{type:"tip",children:(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(10211).A+"",children:"Download Example project spreadcheetah "})})}),"\n",(0,n.jsx)(t.h3,{id:"share-spreadcheetah",children:"Share spreadcheetah"}),"\n",(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah&quote=spreadcheetah",title:"Share on Facebook",target:"_blank",children:"Share on Facebook"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://twitter.com/intent/tweet?source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah&text=spreadcheetah:%20https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah",target:"_blank",title:"Tweet",children:"Share in Twitter"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"http://www.reddit.com/submit?url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah&title=spreadcheetah",target:"_blank",title:"Submit to Reddit",children:"Share on Reddit"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah&title=spreadcheetah&summary=&source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2Fspreadcheetah",target:"_blank",title:"Share on LinkedIn",children:"Share on Linkedin"})})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/spreadcheetah",children:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/spreadcheetah"})}),"\n",(0,n.jsx)(t.h3,{id:"in-the-same-category-templating---11-other-generators",children:"In the same category (Templating) - 11 other generators"}),"\n",(0,n.jsx)(t.h4,{id:"gobie",children:(0,n.jsx)(t.a,{href:"/docs/Gobie",children:"Gobie"})}),"\n",(0,n.jsx)(t.h4,{id:"interceptortemplate",children:(0,n.jsx)(t.a,{href:"/docs/InterceptorTemplate",children:"InterceptorTemplate"})}),"\n",(0,n.jsx)(t.h4,{id:"jktoolkittemplatepropertygenerator",children:(0,n.jsx)(t.a,{href:"/docs/JKToolKit.TemplatePropertyGenerator",children:"JKToolKit.TemplatePropertyGenerator"})}),"\n",(0,n.jsx)(t.h4,{id:"microsoftnetsdkrazorsourcegenerators",children:(0,n.jsx)(t.a,{href:"/docs/Microsoft.NET.Sdk.Razor.SourceGenerators",children:"Microsoft.NET.Sdk.Razor.SourceGenerators"})}),"\n",(0,n.jsx)(t.h4,{id:"mineralsautomixins",children:(0,n.jsx)(t.a,{href:"/docs/Minerals.AutoMixins",children:"Minerals.AutoMixins"})}),"\n",(0,n.jsx)(t.h4,{id:"morrismoxy",children:(0,n.jsx)(t.a,{href:"/docs/MorrisMoxy",children:"MorrisMoxy"})}),"\n",(0,n.jsx)(t.h4,{id:"ntypewriter",children:(0,n.jsx)(t.a,{href:"/docs/NTypewriter",children:"NTypewriter"})}),"\n",(0,n.jsx)(t.h4,{id:"razorblade",children:(0,n.jsx)(t.a,{href:"/docs/RazorBlade",children:"RazorBlade"})}),"\n",(0,n.jsx)(t.h4,{id:"razorslices",children:(0,n.jsx)(t.a,{href:"/docs/RazorSlices",children:"RazorSlices"})}),"\n",(0,n.jsx)(t.h4,{id:"rscg_iformattable",children:(0,n.jsx)(t.a,{href:"/docs/RSCG_IFormattable",children:"RSCG_IFormattable"})}),"\n",(0,n.jsx)(t.h4,{id:"rscg_templating",children:(0,n.jsx)(t.a,{href:"/docs/RSCG_Templating",children:"RSCG_Templating"})})]})}function g(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(x,{...e})}):x(e)}},10211:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/files/spreadcheetah-39dc73fbe9b2685ad29a3104fbd33514.zip"}}]);