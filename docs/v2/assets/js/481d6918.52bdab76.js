"use strict";(self.webpackChunkrscg_examples=self.webpackChunkrscg_examples||[]).push([[5947],{3829:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>y,frontMatter:()=>o,metadata:()=>m,toc:()=>u});var n=a(7462),i=(a(7294),a(4137)),r=a(3992),p=a(425),s=a(8839);const o={sidebar_position:770,title:"77 - DynamicsMapper",description:"Mapper for Dataverse client - generates also column names from properties",slug:"/DynamicsMapper"},l="DynamicsMapper  by Yonatan Cohavi",m={unversionedId:"RSCG-Examples/DynamicsMapper",id:"RSCG-Examples/DynamicsMapper",title:"77 - DynamicsMapper",description:"Mapper for Dataverse client - generates also column names from properties",source:"@site/docs/RSCG-Examples/DynamicsMapper.md",sourceDirName:"RSCG-Examples",slug:"/DynamicsMapper",permalink:"/RSCG_Examples/v2/docs/DynamicsMapper",draft:!1,tags:[],version:"current",sidebarPosition:770,frontMatter:{sidebar_position:770,title:"77 - DynamicsMapper",description:"Mapper for Dataverse client - generates also column names from properties",slug:"/DynamicsMapper"},sidebar:"tutorialSidebar",previous:{title:"76 - UnitGenerator",permalink:"/RSCG_Examples/v2/docs/UnitGenerator"},next:{title:"78 - MinimalApiBuilder",permalink:"/RSCG_Examples/v2/docs/MinimalApiBuilder"}},c={},u=[{value:"Details",id:"details",level:2},{value:"Info",id:"info",level:3},{value:"Original Readme",id:"original-readme",level:3},{value:"About",id:"about",level:3},{value:"How to use",id:"how-to-use",level:2},{value:"Example ( source csproj, source files )",id:"example--source-csproj-source-files-",level:3},{value:"Generated Files",id:"generated-files",level:3},{value:"Usefull",id:"usefull",level:2},{value:"Download Example (.NET  C# )",id:"download-example-net--c-",level:3},{value:"Share DynamicsMapper",id:"share-dynamicsmapper",level:3},{value:"In the same category (Mapper)",id:"in-the-same-category-mapper",level:2},{value:"AutoDTO",id:"autodto",level:3},{value:"MagicMap",id:"magicmap",level:3},{value:"mapperly",id:"mapperly",level:3},{value:"MapTo",id:"mapto",level:3},{value:"NextGenMapper",id:"nextgenmapper",level:3}],d={toc:u},h="wrapper";function y(e){let{components:t,...o}=e;return(0,i.kt)(h,(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"dynamicsmapper--by-yonatan-cohavi"},"DynamicsMapper  by Yonatan Cohavi"),(0,i.kt)(s.Z,{toc:u,mdxType:"TOCInline"}),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/YC.DynamicsMapper/"},(0,i.kt)("img",{parentName:"a",src:"https://img.shields.io/nuget/dt/YC.DynamicsMapper?label=YC.DynamicsMapper",alt:"Nuget"})),"\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/YonatanCohavi/DynamicsMapper/"},(0,i.kt)("img",{parentName:"a",src:"https://img.shields.io/github/last-commit/YonatanCohavi/DynamicsMapper?label=updated",alt:"GitHub last commit"})),"\n",(0,i.kt)("img",{parentName:"p",src:"https://img.shields.io/github/stars/YonatanCohavi/DynamicsMapper?style=social",alt:"GitHub Repo stars"})),(0,i.kt)("h2",{id:"details"},"Details"),(0,i.kt)("h3",{id:"info"},"Info"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Name: ",(0,i.kt)("strong",{parentName:"p"},"DynamicsMapper")),(0,i.kt)("p",{parentName:"admonition"},"A .NET source generator for generating dynamics crm Enity mappings.\nNo runtime reflection."),(0,i.kt)("p",{parentName:"admonition"},"Author: Yonatan Cohavi"),(0,i.kt)("p",{parentName:"admonition"},"NuGet:\n",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("a",{parentName:"em",href:"https://www.nuget.org/packages/YC.DynamicsMapper/"},"https://www.nuget.org/packages/YC.DynamicsMapper/")),"   "),(0,i.kt)("p",{parentName:"admonition"},"You can find more details at ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/YonatanCohavi/DynamicsMapper/"},"https://github.com/YonatanCohavi/DynamicsMapper/")),(0,i.kt)("p",{parentName:"admonition"},"Source : ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/YonatanCohavi/DynamicsMapper/"},"https://github.com/YonatanCohavi/DynamicsMapper/"))),(0,i.kt)("h3",{id:"original-readme"},"Original Readme"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("h1",{parentName:"admonition",id:"using-the-source-generator"},"Using the Source Generator"),(0,i.kt)("p",{parentName:"admonition"},"This document provides a brief overview of how to use the source generator to generate mapper classes for your entity classes."),(0,i.kt)("h2",{parentName:"admonition",id:"step-1-define-your-entity-classes"},"Step 1: Define Your Entity Classes"),(0,i.kt)("p",{parentName:"admonition"},"First, you need to define your entity classes and decorate them with the ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmEntity")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmField")," attributes. These attributes specify the mapping between your entity classes and the corresponding CRM entities."),(0,i.kt)("p",{parentName:"admonition"},"For example, here is a sample ",(0,i.kt)("inlineCode",{parentName:"p"},"Person")," class decorated with the ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmEntity")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmField")," attributes:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'[CrmEntity("person")]\npublic class Person\n{\n    [CrmField("personid", Mapping = MappingType.PrimaryId)]\n    public Guid PersonId { get; set; }\n\n    [CrmField("firstname")]\n    public string? FirstName { get; set; }\n\n    [CrmField("lastname")]\n    public string? LastName { get; set; }\n}\n')),(0,i.kt)("h2",{parentName:"admonition",id:"step-2-run-the-source-generator"},"Step 2: Run the Source Generator"),(0,i.kt)("p",{parentName:"admonition"},"The source generator is executed automatically when you build your project. This will generate the mapper classes for each of your entity classes. The mapper classes implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"IEntityMapper<TEntity>")," interface and are responsible for mapping between your entity classes and the corresponding CRM entities."),(0,i.kt)("h2",{parentName:"admonition",id:"step-3-use-the-mapper-classes"},"Step 3: Use the Mapper Classes"),(0,i.kt)("p",{parentName:"admonition"},"Once the mapper classes have been generated, you can use them to map between your entity classes and the CRM entities. To do this, you need to create an instance of the appropriate mapper class and call its ",(0,i.kt)("inlineCode",{parentName:"p"},"Map")," methods."),(0,i.kt)("p",{parentName:"admonition"},"For example, here is how you might use the ",(0,i.kt)("inlineCode",{parentName:"p"},"PersonMapper")," class to map between a ",(0,i.kt)("inlineCode",{parentName:"p"},"Person")," object and a CRM entity:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'var person = new Person { PersonId = Guid.NewGuid(), FirstName = "John", LastName = "Doe" };\nvar mapper = new PersonMapper();\nvar entity = mapper.Map(person);\n')),(0,i.kt)("p",{parentName:"admonition"},"You can also use the ",(0,i.kt)("inlineCode",{parentName:"p"},"Map")," method to map from a CRM entity to a ",(0,i.kt)("inlineCode",{parentName:"p"},"Person")," object. Here is an example:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'var entity = new Entity("person");\nentity.Id = Guid.NewGuid();\nentity["firstname"] = "Jane";\nentity["lastname"] = "Doe";\n\nvar mapper = new PersonMapper();\nvar person = mapper.Map(entity);\n')),(0,i.kt)("h2",{parentName:"admonition",id:"mapping-types"},"Mapping Types"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Basic"),": This is the default mapping type and is used for simple data types such as strings, integers, and booleans."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Lookup"),": This mapping type is used for lookup fields in the CRM entity. A lookup field is a field that references another entity record."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Money"),": This mapping type is used for money fields in the CRM entity. A money field is a field that stores currency values."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Formatted"),": This mapping type is used for formatted fields in the CRM entity. A formatted field is a field that has a specific format, such as a date or time field."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Options"),": This mapping type is used for option set fields in the CRM entity. An option set field is a field that allows the user to select from a predefined set of options."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"MultipleOptions"),": This mapping type is used for multi-select option set fields in the CRM entity. A multi-select option set field is a field that allows the user to select multiple options from a predefined set of options."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"PrimaryId"),": This mapping type is used for the primary ID field of the CRM entity. The primary ID field is the unique identifier for the entity record.")),(0,i.kt)("h2",{parentName:"admonition",id:"define-linked-entities-with-the-crmlink-attribute"},"Define Linked Entities with the CrmLink Attribute"),(0,i.kt)("p",{parentName:"admonition"},"In addition to the ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmEntity")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmField")," attributes, you can also use the ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmLink")," attribute to map linked entities. This attribute allows you to establish relationships between different entities in your CRM."),(0,i.kt)("p",{parentName:"admonition"},"Here's how you can use it:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'[CrmEntity("order")]\npublic class Order\n{\n    [CrmField("orderid", Mapping = MappingType.PrimaryId)]\n    public Guid OrderId { get; set; }\n\n    [CrmField("totalamount")]\n    public decimal? TotalAmount { get; set; }\n\n    [CrmLink("person")]\n    public Person Person { get; set; }\n}\n')),(0,i.kt)("p",{parentName:"admonition"},"In the example above, the ",(0,i.kt)("inlineCode",{parentName:"p"},"Order")," class has a ",(0,i.kt)("inlineCode",{parentName:"p"},"Person")," property that represents the person associated with the order. The ",(0,i.kt)("inlineCode",{parentName:"p"},"CrmLink")," attribute is used to specify that this property maps to a linked entity in the CRM."),(0,i.kt)("p",{parentName:"admonition"},"And that's it! You can now use the source generator to generate mapper classes for your entity classes and easily map between your entity classes and the corresponding CRM entities.")),(0,i.kt)("h3",{id:"about"},"About"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Mapper for Dataverse client - generates also column names from properties")),(0,i.kt)("h2",{id:"how-to-use"},"How to use"),(0,i.kt)("h3",{id:"example--source-csproj-source-files-"},"Example ( source csproj, source files )"),(0,i.kt)(r.Z,{mdxType:"Tabs"},(0,i.kt)(p.Z,{value:"csproj",label:"CSharp Project",mdxType:"TabItem"},(0,i.kt)("p",null,"This is the CSharp Project that references ",(0,i.kt)("strong",{parentName:"p"},"DynamicsMapper")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml",metastring:"showLineNumbers {17}",showLineNumbers:!0,"{17}":!0},'<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net7.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n    <PropertyGroup>\n        <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>\n        <CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\\GX</CompilerGeneratedFilesOutputPath>\n    </PropertyGroup>\n\n    <ItemGroup>\n      <PackageReference Include="Microsoft.PowerPlatform.Dataverse.Client" Version="1.1.14" />\n      <PackageReference Include="YC.DynamicsMapper" Version="1.0.8" />\n    </ItemGroup>\n</Project>\n\n'))),(0,i.kt)(p.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\DynamicsMapper\\src\\MapperDemo\\Program.cs",label:"Program.cs",mdxType:"TabItem"},(0,i.kt)("p",null,"  This is the use of ",(0,i.kt)("strong",{parentName:"p"},"DynamicsMapper")," in ",(0,i.kt)("em",{parentName:"p"},"Program.cs")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},"using NextGenMapperDemo;\nvar pm = new PersonMapper();\nConsole.WriteLine(pm.Entityname);\n"))),(0,i.kt)(p.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\DynamicsMapper\\src\\MapperDemo\\Person.cs",label:"Person.cs",mdxType:"TabItem"},(0,i.kt)("p",null,"  This is the use of ",(0,i.kt)("strong",{parentName:"p"},"DynamicsMapper")," in ",(0,i.kt)("em",{parentName:"p"},"Person.cs")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},'\nusing DynamicsMapper.Abstractions;\n\nnamespace NextGenMapperDemo;\n\n\n[CrmEntity("person")]\npublic class Person\n{\n    [CrmField("personid", Mapping = MappingType.PrimaryId)]\n    public Guid ID { get; set; }\n    [CrmField("name")]\n\n    public string? Name { get; set; }\n}\n')))),(0,i.kt)("h3",{id:"generated-files"},"Generated Files"),(0,i.kt)("p",null,"Those are taken from $(BaseIntermediateOutputPath)\\GX"),(0,i.kt)(r.Z,{mdxType:"Tabs"},(0,i.kt)(p.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\DynamicsMapper\\src\\MapperDemo\\obj\\GX\\DynamicsMapper\\DynamicsMapper.MapperGenerator\\EntityExtentions.g.cs",label:"EntityExtentions.g.cs",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},"// <auto-generated />\n#nullable enable\nusing Microsoft.Xrm.Sdk;\nusing System.Linq;\n\nnamespace DynamicsMapper.Extension\n{\n    public static class EntityExtension\n    {\n        public static Entity? GetAliasedEntity(this Entity entity, string alias)\n        {\n            var attributes = entity.Attributes.Where(e => e.Key.StartsWith(alias)).ToArray();\n            if (!attributes.Any())\n                return null;\n            var aliasEntity = new Entity();\n            foreach (var attribute in attributes)\n            {\n                if (!(attribute.Value is AliasedValue aliasedValued))\n                    continue;\n                if (string.IsNullOrEmpty(aliasEntity.LogicalName))\n                    aliasEntity.LogicalName = aliasedValued.EntityLogicalName;\n                aliasEntity[aliasedValued.AttributeLogicalName] = aliasedValued.Value;\n            }\n\n            return aliasEntity;\n        }\n    }\n}\n"))),(0,i.kt)(p.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\DynamicsMapper\\src\\MapperDemo\\obj\\GX\\DynamicsMapper\\DynamicsMapper.MapperGenerator\\IEntityMapper.g.cs",label:"IEntityMapper.g.cs",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},"// <auto-generated />\n#nullable enable\nusing Microsoft.Xrm.Sdk;\nusing Microsoft.Xrm.Sdk.Query;\n\nnamespace DynamicsMapper.Mappers\n{\n    public interface IEntityMapper<T>\n    {\n        public string Entityname { get; }\n        public ColumnSet Columns { get; }\n\n        public T Map(Entity entity);\n        public T? Map(Entity entity, string alias);\n        public Entity Map(T model);\n    }\n}\n"))),(0,i.kt)(p.Z,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\DynamicsMapper\\src\\MapperDemo\\obj\\GX\\DynamicsMapper\\DynamicsMapper.MapperGenerator\\PersonMapper.g.cs",label:"PersonMapper.g.cs",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:"showLineNumbers",showLineNumbers:!0},'// <auto-generated />\n#nullable enable\nusing Microsoft.Xrm.Sdk;\nusing Microsoft.Xrm.Sdk.Query;\nusing DynamicsMapper.Extension;\nusing DynamicsMapper.Mappers;\nusing System;\n\nnamespace NextGenMapperDemo\n{\n    public class PersonMapper : IEntityMapper<Person>\n    {\n        private static readonly string[] columns = new[]\n        {\n            "personid",\n            "name"\n        };\n        public ColumnSet Columns => new ColumnSet(columns);\n\n        private const string entityname = "person";\n        public string Entityname => entityname;\n\n        public Entity Map(Person person)\n        {\n            var entity = new Entity(entityname);\n            entity.Id = person.ID;\n            entity["name"] = person.Name;\n            return entity;\n        }\n\n        public Person? Map(Entity entity, string alias) => InternalMap(entity, alias);\n        public Person Map(Entity entity) => InternalMap(entity)!;\n        private static Person? InternalMap(Entity source, string? alias = null)\n        {\n            Entity? entity;\n            if (string.IsNullOrEmpty(alias))\n            {\n                entity = source;\n            }\n            else\n            {\n                entity = source.GetAliasedEntity(alias);\n                if (entity is null)\n                    return null;\n            }\n\n            if (entity?.LogicalName != entityname)\n                throw new ArgumentException($"entity LogicalName expected to be {entityname} recived: {entity?.LogicalName}", "entity");\n            var person = new Person();\n            person.ID = entity.GetAttributeValue<Guid>("personid");\n            person.Name = entity.GetAttributeValue<string?>("name");\n            return person;\n        }\n    }\n}\n')))),(0,i.kt)("h2",{id:"usefull"},"Usefull"),(0,i.kt)("h3",{id:"download-example-net--c-"},"Download Example (.NET  C# )"),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{target:"_blank",href:a(5323).Z},"Download Example project DynamicsMapper "))),(0,i.kt)("h3",{id:"share-dynamicsmapper"},"Share DynamicsMapper"),(0,i.kt)("ul",null,(0,i.kt)("li",null,(0,i.kt)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper&quote=DynamicsMapper",title:"Share on Facebook",target:"_blank"},"Share on Facebook")),(0,i.kt)("li",null,(0,i.kt)("a",{href:"https://twitter.com/intent/tweet?source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper&text=DynamicsMapper:%20https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper",target:"_blank",title:"Tweet"},"Share in Twitter")),(0,i.kt)("li",null,(0,i.kt)("a",{href:"http://www.reddit.com/submit?url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper&title=DynamicsMapper",target:"_blank",title:"Submit to Reddit"},"Share on Reddit")),(0,i.kt)("li",null,(0,i.kt)("a",{href:"http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper&title=DynamicsMapper&summary=&source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FDynamicsMapper",target:"_blank",title:"Share on LinkedIn"},"Share on Linkedin"))),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/DynamicsMapper"},"https://ignatandrei.github.io/RSCG_Examples/v2/docs/DynamicsMapper")),(0,i.kt)("h2",{id:"in-the-same-category-mapper"},"In the same category (Mapper)"),(0,i.kt)("h3",{id:"autodto"},(0,i.kt)("a",{parentName:"h3",href:"/docs/AutoDTO"},"AutoDTO")),(0,i.kt)("h3",{id:"magicmap"},(0,i.kt)("a",{parentName:"h3",href:"/docs/MagicMap"},"MagicMap")),(0,i.kt)("h3",{id:"mapperly"},(0,i.kt)("a",{parentName:"h3",href:"/docs/mapperly"},"mapperly")),(0,i.kt)("h3",{id:"mapto"},(0,i.kt)("a",{parentName:"h3",href:"/docs/MapTo"},"MapTo")),(0,i.kt)("h3",{id:"nextgenmapper"},(0,i.kt)("a",{parentName:"h3",href:"/docs/NextGenMapper"},"NextGenMapper")))}y.isMDXComponent=!0},5323:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/files/DynamicsMapper-950fc512ab6388f300a2105ec854c249.zip"}}]);