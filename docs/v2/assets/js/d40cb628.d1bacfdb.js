"use strict";(self.webpackChunkrscg_examples=self.webpackChunkrscg_examples||[]).push([[3822],{4137:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>g});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),u=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,g=d["".concat(s,".").concat(m)]||d[m]||c[m]||l;return r?a.createElement(g,i(i({ref:t},p),{},{components:r})):a.createElement(g,i({ref:t},p))}));function g(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=r.length,i=new Array(l);i[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[d]="string"==typeof e?e:n,i[1]=o;for(var u=2;u<l;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},5486:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var a=r(7462),n=(r(7294),r(4137));const l={},i=void 0,o={unversionedId:"RSCG-Examples/GeneratorEquals_readme",id:"RSCG-Examples/GeneratorEquals_readme",title:"GeneratorEquals_readme",description:"Nuget",source:"@site/docs/RSCG-Examples/GeneratorEquals_readme.md",sourceDirName:"RSCG-Examples",slug:"/RSCG-Examples/GeneratorEquals_readme",permalink:"/RSCG_Examples/v2/docs/RSCG-Examples/GeneratorEquals_readme",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Gedaq_readme",permalink:"/RSCG_Examples/v2/docs/RSCG-Examples/Gedaq_readme"},next:{title:"Immutype",permalink:"/RSCG_Examples/v2/docs/RSCG-Examples/Immutype_readme"}},s={},u=[{value:"Requirements",id:"requirements",level:2},{value:"Installation",id:"installation",level:2},{value:"Migrating from version 2",id:"migrating-from-version-2",level:2},{value:"Usage",id:"usage",level:2},{value:"Supported Comparers",id:"supported-comparers",level:2},{value:"Default",id:"default",level:3},{value:"IgnoreEquality",id:"ignoreequality",level:3},{value:"OrderedEquality",id:"orderedequality",level:3},{value:"UnorderedEquality",id:"unorderedequality",level:3},{value:"SetEquality",id:"setequality",level:3},{value:"ReferenceEquality",id:"referenceequality",level:3},{value:"CustomEquality",id:"customequality",level:3},{value:"Advanced Options",id:"advanced-options",level:2},{value:"Explicit Mode",id:"explicit-mode",level:3},{value:"Ignore Inherited Members",id:"ignore-inherited-members",level:3}],p={toc:u},d="wrapper";function c(e){let{components:t,...r}=e;return(0,n.kt)(d,(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/Generator.Equals/"},(0,n.kt)("img",{parentName:"a",src:"https://img.shields.io/nuget/v/Generator.Equals",alt:"Nuget"}))),(0,n.kt)("h1",{id:"generatorequals"},"Generator.Equals"),(0,n.kt)("p",null,"A source code generator for automatically implementing IEquatable","<","T",">"," using only attributes."),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"requirements"},"Requirements"),(0,n.kt)("p",null,"In order to use this library, you must:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Use a target framework that supports .NET Standard >= 2.0"),(0,n.kt)("li",{parentName:"ul"},"Set your project's C# ",(0,n.kt)("inlineCode",{parentName:"li"},"LangVersion")," property to 9.0 or higher.")),(0,n.kt)("h2",{id:"installation"},"Installation"),(0,n.kt)("p",null,"Simply add the package ",(0,n.kt)("inlineCode",{parentName:"p"},"Generator.Equals")," to your project. Keep reading to learn how to add the attributes to your types."),(0,n.kt)("h2",{id:"migrating-from-version-2"},"Migrating from version 2"),(0,n.kt)("p",null,"Migrating to version 3 is very straightforward."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Ensure projects are targeting C# 9.0 or latter using the MSBuild property ",(0,n.kt)("inlineCode",{parentName:"li"},"LangVersion"),"."),(0,n.kt)("li",{parentName:"ol"},"Be aware that ",(0,n.kt)("inlineCode",{parentName:"li"},"IEquatable<T>")," for classes is now implemented explicitly in order to support deep equality. As a result, the method ",(0,n.kt)("inlineCode",{parentName:"li"},"Equals(T)")," method is no longer marked as public. Most code should still work, requiring only to be recompiled as the ABI has changed.")),(0,n.kt)("p",null,"If you have an existing project using ",(0,n.kt)("inlineCode",{parentName:"p"},"Generator.Equals")," and don't need any of the new features, you can still use version 2.x. The differences are minimal between both major versions."),(0,n.kt)("h2",{id:"usage"},"Usage"),(0,n.kt)("p",null,"The below sample shows how to use Generator.Equals to override the default equality implementation for a C# record, enhancing it with the ability to determine the equality between the array contents of the record."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},'using Generator.Equals;\n\n[Equatable]\npartial record MyRecord(\n    [property: OrderedEquality] string[] Fruits\n);\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        var record1 = new MyRecord(new[] {"banana", "apple"});\n        var record2 = new MyRecord(new[] {"banana", "apple"});\n\n        Console.WriteLine(record1 == record2);\n    }\n}\n')),(0,n.kt)("p",null,"Need more than records? Generator.Equals supports properties (and fields) also across classes, structs and record structs."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"using Generator.Equals;\n\n[Equatable]\npartial class MyClass\n{\n    [DefaultEquality] \n    private int _secretNumber = 42;\n\n    [OrderedEquality] \n    public string[] Fruits { get; set; }\n}\n\n[Equatable]\npartial struct MyStruct\n{\n    [OrderedEquality] \n    public string[] Fruits { get; set; }\n}\n\n[Equatable]\npartial record struct MyRecordStruct(\n    [property: OrderedEquality] string[] Fruits\n);\n")),(0,n.kt)("h2",{id:"supported-comparers"},"Supported Comparers"),(0,n.kt)("p",null,"Below is a list of all supported comparers. Would you like something else added? Let me know by raising an issue or sending a PR!"),(0,n.kt)("h3",{id:"default"},"Default"),(0,n.kt)("p",null,"This is the comparer that's used when a property has no attributes indicating otherwise. The generated code will use\n",(0,n.kt)("inlineCode",{parentName:"p"},"EqualityComparer<T>.Default")," for both equals and hashing operation."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("em",{parentName:"p"},"Fields are not used in comparison unless explicitly annotated. To enable the default comparison for a field, annotate it with the ",(0,n.kt)("inlineCode",{parentName:"em"},"DefaultEquality")," attribute."))),(0,n.kt)("h3",{id:"ignoreequality"},"IgnoreEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"[IgnoreEquality] \npublic string Name { get; set; }\n")),(0,n.kt)("p",null,"As the name implies, the property is ignored during Equals and GetHashCode calls!"),(0,n.kt)("h3",{id:"orderedequality"},"OrderedEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"[OrderedEquality] \npublic string[] Fruits { get; set; } // Fruits have to be in the same order for the array to be considered equal.\n")),(0,n.kt)("p",null,"This equality comparer will compare properties as a sequence instead of a reference. This works just like ",(0,n.kt)("inlineCode",{parentName:"p"},"Enumerable.SequenceEqual"),", which assumes both lists are of the same size and same sort."),(0,n.kt)("p",null,"Bear in mind that the property has to implement IEnumerable and the that the items themselves implement equality (you can use Generator.Equals in the items too!)."),(0,n.kt)("h3",{id:"unorderedequality"},"UnorderedEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"[UnorderedEquality] \npublic string[] Fruits { get; set; } // Does not care about the order of the fruits!\n\n[UnorderedEquality] \npublic IDictionary<string, object> Properties { get; set; } // Works with dictionaries too!\n")),(0,n.kt)("p",null,"This equality comparer will compare properties as an unordered sequence instead of a reference. This works just like ",(0,n.kt)("inlineCode",{parentName:"p"},"Enumerable.SequenceEqual"),", but it does not care about the order as long as the all values (including the repetitions) are present."),(0,n.kt)("p",null,"As with OrderedEquality, bear in mind that the property (or key and values if using a dictionary) has to implement IEnumerable and the that the items themselves implement equality (you can use Generator.Equals in the items too!)."),(0,n.kt)("h3",{id:"setequality"},"SetEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"[SetEquality] \npublic HashSet<string> Fruits { get; set; } // Fruits can be in any order and it can be repeated\n")),(0,n.kt)("p",null,"This equality comparer will do a set comparison, using ",(0,n.kt)("inlineCode",{parentName:"p"},"SetEquals")," whenever the underlying collection implements ",(0,n.kt)("inlineCode",{parentName:"p"},"ISet<T>"),", otherwise falling back to  manually comparing both collections, which can be expensive for large collections."),(0,n.kt)("p",null,"Hashing always returns 0 for this type of equality,"),(0,n.kt)("h3",{id:"referenceequality"},"ReferenceEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"[ReferenceEquality] \npublic string Name { get; set; } // Will only return true if strings are the same reference (eg. when used with string.Intern)\n")),(0,n.kt)("p",null,"This will ignore whatever equality is implemented for a particular object and compare references instead."),(0,n.kt)("h3",{id:"customequality"},"CustomEquality"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-c#"},"class LengthEqualityComparer : IEqualityComparer<string>\n{\n    public static readonly LengthEqualityComparer Default = new();\n\n    public bool Equals(string? x, string? y) => x?.Length == y?.Length;\n\n    public int GetHashCode(string obj) => obj.Length.GetHashCode();\n}\n\nclass NameEqualityComparer \n{\n    public static readonly IEqualityComparer<string> Default = new SomeCustomComparer();\n}\n\n\n[CustomEquality(typeof(LengthEqualityComparer))] \npublic string Name1 { get; set; } // Will use LengthEqualityComparer to compare the values of Name1.\n\n[CustomEquality(typeof(NameEqualityComparer))] \npublic string Name2 { get; set; } // Will use NameEqualityComparer.Default to compare values of Name2.\n\n[CustomEquality(typeof(StringComparer), nameof(StringComparer.OrdinalIgnoreCase))] \npublic string Name2 { get; set; } // Will use StringComparer.OrdinalIgnoreCase to compare values of Name2.\n")),(0,n.kt)("p",null,"This attribute allows you to specify a custom comparer for a particular property. For it to work, the type passed as an\nargument to CustomEqualityAttribute should fulfill AT LEAST one of the following:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Have a static field/property named Default returning a valid IEqualityComparer instance for the target type;"),(0,n.kt)("li",{parentName:"ul"},"Have a static field/property with the same name passed to the CustomComparerAttribute returning a valid IEqualityComparer instance for the target type;"),(0,n.kt)("li",{parentName:"ul"},"Implement IEqualityComparer and expose a parameterless constructor.")),(0,n.kt)("h2",{id:"advanced-options"},"Advanced Options"),(0,n.kt)("h3",{id:"explicit-mode"},"Explicit Mode"),(0,n.kt)("p",null,"The generator allows you to explicitly specify which properties are used to generate the ",(0,n.kt)("inlineCode",{parentName:"p"},"IEquatable"),".  "),(0,n.kt)("p",null,"To do this, set the ",(0,n.kt)("inlineCode",{parentName:"p"},"Explicit")," property of ",(0,n.kt)("inlineCode",{parentName:"p"},"EquatableAttribute")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," and specify the required properties using ",(0,n.kt)("inlineCode",{parentName:"p"},"DefaultEqualityAttribute")," or other attributes."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-cs"},'using Generator.Equals;\n\n[Equatable(Explicit = true)]\npartial class MyClass\n{\n    // Only this property will be used for equality!\n    [DefaultEquality] \n    public string Name { get; set; } = "Konstantin"; \n    \n    public string Description { get; set; } = "";\n}\n')),(0,n.kt)("h3",{id:"ignore-inherited-members"},"Ignore Inherited Members"),(0,n.kt)("p",null,"You can also choose to ignore members from parent classes/record by setting ",(0,n.kt)("inlineCode",{parentName:"p"},"IgnoreInheritedMembers")," to true."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-cs"},"using Generator.Equals;\n\nclass Person \n{\n    public string Name { get; set; }\n}\n\n[Equatable(IgnoreInheritedMembers = true)]\npartial class Doctor : Person\n{\n    // Only members in the Doctor class will be used for comparison.\n    public string Id { get; set; }\n    public string Specialization { get; set; }\n}\n")))}c.isMDXComponent=!0}}]);