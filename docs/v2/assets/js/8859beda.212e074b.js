"use strict";(self.webpackChunkrscg_examples=self.webpackChunkrscg_examples||[]).push([[86459],{72101:(e,t,n)=>{n.d(t,{Ay:()=>r,RM:()=>o});var a=n(74848),s=n(28453);const o=[{value:"Category &quot;Interface&quot; has the following generators:",id:"category-interface-has-the-following-generators",level:3},{value:"See category",id:"see-category",level:3}];function i(e){const t={a:"a",h3:"h3",img:"img",p:"p",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h3,{id:"category-interface-has-the-following-generators",children:'Category "Interface" has the following generators:'}),"\n",(0,a.jsxs)(t.p,{children:["1 ",(0,a.jsx)(t.a,{href:"/docs/AutoInterface",children:"AutoInterface"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/AutoInterface/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/AutoInterface?label=AutoInterface",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/BlackWhiteYoshi/AutoInterface?style=social",alt:"GitHub Repo stars"})," 2025-07-25"]}),"\n",(0,a.jsxs)(t.p,{children:["2 ",(0,a.jsx)(t.a,{href:"/docs/Biwen.AutoClassGen",children:"Biwen.AutoClassGen"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Biwen.AutoClassGen/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Biwen.AutoClassGen?label=Biwen.AutoClassGen",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/vipwan/Biwen.AutoClassGen?style=social",alt:"GitHub Repo stars"})," 2023-11-16"]}),"\n",(0,a.jsxs)(t.p,{children:["3 ",(0,a.jsx)(t.a,{href:"/docs/CopyCat",children:"CopyCat"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Copycat/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Copycat?label=Copycat",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/Otaman/Copycat?style=social",alt:"GitHub Repo stars"})," 2024-01-09"]}),"\n",(0,a.jsxs)(t.p,{children:["4 ",(0,a.jsx)(t.a,{href:"/docs/Farskeptic.AutoCompose",children:"Farskeptic.AutoCompose"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Farskeptic.AutoCompose/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Farskeptic.AutoCompose?label=Farskeptic.AutoCompose",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/farskeptic/AutoCompose?style=social",alt:"GitHub Repo stars"})," 2024-03-16"]}),"\n",(0,a.jsxs)(t.p,{children:["5 ",(0,a.jsx)(t.a,{href:"/docs/MakeInterface.Generator",children:"MakeInterface.Generator"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/MakeInterface.Generator/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/MakeInterface.Generator?label=MakeInterface.Generator",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/Frederik91/MakeInterface?style=social",alt:"GitHub Repo stars"})," 2024-01-19"]}),"\n",(0,a.jsxs)(t.p,{children:["6 ",(0,a.jsx)(t.a,{href:"/docs/Matryoshki",children:"Matryoshki"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Matryoshki/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Matryoshki?label=Matryoshki",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/krasin-ga/matryoshki?style=social",alt:"GitHub Repo stars"})," 2023-08-03"]}),"\n",(0,a.jsxs)(t.p,{children:["7 ",(0,a.jsx)(t.a,{href:"/docs/Minerals.AutoInterfaces",children:"Minerals.AutoInterfaces"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Minerals.AutoInterfaces/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Minerals.AutoInterfaces?label=Minerals.AutoInterfaces",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/SzymonHalucha/Minerals.AutoInterfaces?style=social",alt:"GitHub Repo stars"})," 2024-04-17"]}),"\n",(0,a.jsxs)(t.p,{children:["8 ",(0,a.jsx)(t.a,{href:"/docs/NetAutomaticInterface",children:"NetAutomaticInterface"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/AutomaticInterface/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/AutomaticInterface?label=AutomaticInterface",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/codecentric/net_automatic_interface?style=social",alt:"GitHub Repo stars"})," 2024-01-29"]}),"\n",(0,a.jsxs)(t.p,{children:["9 ",(0,a.jsx)(t.a,{href:"/docs/ProxyGen",children:"ProxyGen"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/ProxyGen.net/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/ProxyGen.net?label=ProxyGen.net",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/Sholtee/ProxyGen?style=social",alt:"GitHub Repo stars"})," 2023-08-06"]}),"\n",(0,a.jsxs)(t.p,{children:["10 ",(0,a.jsx)(t.a,{href:"/docs/Roozie.AutoInterface",children:"Roozie.AutoInterface"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/Roozie.AutoInterface/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Roozie.AutoInterface?label=Roozie.AutoInterface",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/AlexRussak/Roozie.AutoInterface?style=social",alt:"GitHub Repo stars"})," 2023-08-26"]}),"\n",(0,a.jsxs)(t.p,{children:["11 ",(0,a.jsx)(t.a,{href:"/docs/RSCG_CompositeProvider",children:"RSCG_CompositeProvider"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/RSCG_CompositeProvider/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/RSCG_CompositeProvider?label=RSCG_CompositeProvider",alt:"Nuget"})}),(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/RSCG_CompositeProvider_common/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/RSCG_CompositeProvider_common?label=RSCG_CompositeProvider_common",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/ignatandrei/RSCG_CompositeProvider?style=social",alt:"GitHub Repo stars"})," 2025-02-18"]}),"\n",(0,a.jsxs)(t.p,{children:["12 ",(0,a.jsx)(t.a,{href:"/docs/rscg_Interface_to_null_object",children:"rscg_Interface_to_null_object"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/rscg_Interface_to_null_object/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/rscg_Interface_to_null_object?label=rscg_Interface_to_null_object",alt:"Nuget"})}),(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/rscg_Interface_to_null_object_common",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/rscg_Interface_to_null_object_common?label=rscg_Interface_to_null_object_common",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/ignatandrei/rscg_Interface_to_null_object?style=social",alt:"GitHub Repo stars"})," 2025-01-18"]}),"\n",(0,a.jsxs)(t.p,{children:["13 ",(0,a.jsx)(t.a,{href:"/docs/RSCG_Static",children:"RSCG_Static"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/RSCG_Static/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/RSCG_Static?label=RSCG_Static",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/ignatandrei/RSCG_Static?style=social",alt:"GitHub Repo stars"})," 2023-04-16"]}),"\n",(0,a.jsxs)(t.p,{children:["14 ",(0,a.jsx)(t.a,{href:"/docs/ShadowWriterNullobjects",children:"ShadowWriterNullobjects"})," ",(0,a.jsx)(t.a,{href:"https://www.nuget.org/packages/ShadowWriter/",children:(0,a.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/ShadowWriter?label=ShadowWriter",alt:"Nuget"})})," ",(0,a.jsx)(t.img,{src:"https://img.shields.io/github/stars/StefanStolz/ShadowWriter?style=social",alt:"GitHub Repo stars"})," 2025-07-29"]}),"\n",(0,a.jsx)(t.h3,{id:"see-category",children:"See category"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"/docs/Categories/Interface",children:"Interface"})})]})}function r(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(i,{...e})}):i(e)}},80191:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>d,default:()=>u,frontMatter:()=>h,metadata:()=>a,toc:()=>g});const a=JSON.parse('{"id":"RSCG-Examples/CopyCat","title":"95 - CopyCat","description":"Implementation of the Decorator pattern in C# - only for not implemented methods","source":"@site/docs/RSCG-Examples/CopyCat.md","sourceDirName":"RSCG-Examples","slug":"/CopyCat","permalink":"/RSCG_Examples/v2/docs/CopyCat","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":950,"frontMatter":{"sidebar_position":950,"title":"95 - CopyCat","description":"Implementation of the Decorator pattern in C# - only for not implemented methods","slug":"/CopyCat"},"sidebar":"tutorialSidebar","previous":{"title":"94 - AspectGenerator","permalink":"/RSCG_Examples/v2/docs/AspectGenerator"},"next":{"title":"96 - HsuSgSync","permalink":"/RSCG_Examples/v2/docs/HsuSgSync"}}');var s=n(74848),o=n(28453),i=n(11470),r=n(19365),c=n(14252),l=n(72101);const h={sidebar_position:950,title:"95 - CopyCat",description:"Implementation of the Decorator pattern in C# - only for not implemented methods",slug:"/CopyCat"},d="CopyCat  by Serhii Buta",p={},g=[{value:"NuGet / site data",id:"nuget--site-data",level:2},{value:"Details",id:"details",level:2},{value:"Info",id:"info",level:3},{value:"Original Readme",id:"original-readme",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Logging",id:"logging",level:3},{value:"Retries",id:"retries",level:3},{value:"Advanced",id:"advanced",level:3},{value:"About",id:"about",level:3},{value:"How to use",id:"how-to-use",level:2},{value:"Example (source csproj, source files)",id:"example-source-csproj-source-files",level:3},{value:"Generated Files",id:"generated-files",level:3},{value:"Useful",id:"useful",level:2},{value:"Download Example (.NET  C#)",id:"download-example-net--c",level:3},{value:"Share CopyCat",id:"share-copycat",level:3},...l.RM];function m(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"copycat--by-serhii-buta",children:"CopyCat  by Serhii Buta"})}),"\n",(0,s.jsx)(c.A,{toc:g}),"\n",(0,s.jsx)(t.h2,{id:"nuget--site-data",children:"NuGet / site data"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://www.nuget.org/packages/Copycat/",children:(0,s.jsx)(t.img,{src:"https://img.shields.io/nuget/dt/Copycat?label=Copycat",alt:"Nuget"})}),"\n",(0,s.jsx)(t.a,{href:"https://github.com/Otaman/Copycat/",children:(0,s.jsx)(t.img,{src:"https://img.shields.io/github/last-commit/Otaman/Copycat?label=updated",alt:"GitHub last commit"})}),"\n",(0,s.jsx)(t.img,{src:"https://img.shields.io/github/stars/Otaman/Copycat?style=social",alt:"GitHub Repo stars"})]}),"\n",(0,s.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,s.jsx)(t.h3,{id:"info",children:"Info"}),"\n",(0,s.jsxs)(t.admonition,{type:"info",children:[(0,s.jsxs)(t.p,{children:["Name: ",(0,s.jsx)(t.strong,{children:"CopyCat"})]}),(0,s.jsx)(t.p,{children:"Decorator pattert source generator with user-defined template"}),(0,s.jsx)(t.p,{children:"Author: Serhii Buta"}),(0,s.jsxs)(t.p,{children:["NuGet:\n",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"https://www.nuget.org/packages/Copycat/",children:"https://www.nuget.org/packages/Copycat/"})})]}),(0,s.jsxs)(t.p,{children:["You can find more details at ",(0,s.jsx)(t.a,{href:"https://github.com/Otaman/Copycat/",children:"https://github.com/Otaman/Copycat/"})]}),(0,s.jsxs)(t.p,{children:["Source: ",(0,s.jsx)(t.a,{href:"https://github.com/Otaman/Copycat/",children:"https://github.com/Otaman/Copycat/"})]})]}),"\n",(0,s.jsx)(t.h3,{id:"original-readme",children:"Original Readme"}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsxs)(t.h1,{id:"copycat-nuget-badge",children:["Copycat ",(0,s.jsx)(t.a,{href:"https://www.nuget.org/packages/Copycat",children:(0,s.jsx)(t.img,{src:"https://buildstats.info/nuget/Copycat?includePreReleases=true",alt:"NuGet Badge"})})]}),(0,s.jsxs)(t.p,{children:["Source generator for creating decorators by templates.\nThe source generator intents to simplify implementation of a ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Decorator_pattern",children:"Decorator Pattern"}),"."]}),(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["The package is still in ",(0,s.jsx)(t.em,{children:"beta"}),". Currently, caching is not implemented, so the source generator regenerates output for every input, which may slow down IDEs in larger projects."]}),"\n"]}),(0,s.jsx)(t.h2,{id:"use-cases",children:"Use Cases"}),(0,s.jsx)(t.p,{children:"Les't begin from simple scenario. We need to decorate ISomeInterface:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:"public interface ISomeInterface\n{\n    void DoSomething();\n    void DoSomethingElse(int a, string b);\n}\n"})}),(0,s.jsx)(t.p,{children:"To activate generator, use [Decorate] attribute on a class. The class must be partial and have exactly one interface to decorate:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:"using Copycat;\n\n[Decorate]\npublic partial class SimpleDecorator : ISomeInterface { }\n"})}),(0,s.jsx)(t.p,{children:"In this example, Copycat generates pass-through decorator:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:"// <auto-generated/>\npublic partial class SimpleDecorator\n{\n    private ISomeInterface _decorated;\n    public SimpleDecorator(ISomeInterface decorated)\n    {\n        _decorated = decorated;\n    }\n\n    public void DoSomething() => _decorated.DoSomething();\n\n    public void DoSomethingElse(int a, string b) => _decorated.DoSomethingElse(a, b);\n}\n"})}),(0,s.jsx)(t.p,{children:"Pass-through decorators don't do much, but still can be useful for changing behaviour of particular methods without touching others:"}),(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["Here and after we skip ",(0,s.jsx)(t.code,{children:"using Copycat;"})," and combine user-defined and auto-generated code for brevity"]}),"\n"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:"[Decorate]\npublic partial class SimpleDecorator : ISomeInterface \n{ \n    public void DoSomething()\n    {\n        // actually, do nothing\n    }\n}\n\n// <auto-generated/>\npublic partial class SimpleDecorator\n{\n    private ISomeInterface _decorated;\n    public SimpleDecorator(ISomeInterface decorated)\n    {\n        _decorated = decorated;\n    }\n\n    public void DoSomethingElse(int a, string b) => _decorated.DoSomethingElse(a, b);\n}\n"})}),(0,s.jsx)(t.p,{children:"As we see, Copycat now generates pass-through only for non-implemented methods (DoSomethingElse), allowing us to concentrate on important changes."}),(0,s.jsxs)(t.p,{children:["But what if we want to override behaviour for one method, but throw for all others (assuming we got some huge legacy interface, where most methods are useless for us)?\nNow it's time to play with templates ","\ud83d\ude0e"]}),(0,s.jsx)(t.p,{children:"To make Copycat generate something different from pass-through we need to define a template:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:'public interface IAmPartiallyUseful\n{   \n    void DoSomethingUseful();\n    void DoSomething();\n    void DoSomethingElse();\n}\n\n[Decorate]\npublic partial class ThrowDecorator : IAmPartiallyUseful\n{\n    public void DoSomethingUseful() => Console.WriteLine("I did some work!");\n\n    [Template]\n    private void Throw(Action action) => throw new NotImplementedException();\n}\n\n// <auto-generated/>\npublic partial class ThrowDecorator\n{\n    private IAmPartiallyUseful _decorated;\n    public ThrowDecorator(IAmPartiallyUseful decorated)\n    {\n        _decorated = decorated;\n    }\n\n    /// <see cref = "ThrowDecorator.Throw(Action)"/>\n    public void DoSomething() => throw new NotImplementedException();\n    /// <see cref = "ThrowDecorator.Throw(Action)"/>\n    public void DoSomethingElse() => throw new NotImplementedException();\n}\n'})}),(0,s.jsx)(t.p,{children:"That's better, now we do some work on DoSomethingUseful and throw on DoSomething or DoSomethingElse, but how?\nWe defined a template:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:"[Template]\nprivate void Throw(Action action) {...}\n"})}),(0,s.jsx)(t.p,{children:"Template is a method that takes parameterless delegate which has the same return type as the method itself.\nWe can use any names for the template method and a delegate (as usual, it's better to keep them self-explanatory)."}),(0,s.jsx)(t.p,{children:"We didn't use the delegate in the pevious example because we limited ourselves to simple examples where it wasn't needed.\nNow it's time to explore more real-world scenarios. Decorators fit nicely for aspect-oriented programming (AOP) when using them as wrappers."}),(0,s.jsx)(t.h3,{id:"logging",children:"Logging"}),(0,s.jsx)(t.p,{children:"One of the aspects, than can be separated easily is logging. For example:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:'using System.Diagnostics;\n\npublic interface ISomeInterface\n{\n    void DoNothing();\n    void DoSomething();\n    void DoSomethingElse(int a, string b);\n}\n\n[Decorate]\npublic partial class SimpleDecorator : ISomeInterface\n{\n    private readonly ISomeInterface _decorated;\n\n    public SimpleDecorator(ISomeInterface decorated) => \n        _decorated = decorated;\n\n    [Template]\n    public void CalculateElapsedTime(Action action)\n    {\n        var sw = Stopwatch.StartNew();\n        action();\n        Console.WriteLine($"{nameof(action)} took {sw.ElapsedMilliseconds} ms");\n    }\n    \n    public void DoNothing() { }\n}\n\npublic partial class SimpleDecorator\n{\n    /// <see cref = "SimpleDecorator.CalculateElapsedTime(Action)"/>\n    public void DoSomething()\n    {\n        var sw = Stopwatch.StartNew();\n        _decorated.DoSomething();\n        Console.WriteLine($"{nameof(DoSomething)} took {sw.ElapsedMilliseconds} ms");\n    }\n\n    /// <see cref = "SimpleDecorator.CalculateElapsedTime(Action)"/>\n    public void DoSomethingElse(int a, string b)\n    {\n        var sw = Stopwatch.StartNew();\n        _decorated.DoSomethingElse(a, b);\n        Console.WriteLine($"{nameof(DoSomethingElse)} took {sw.ElapsedMilliseconds} ms");\n    }\n}\n'})}),(0,s.jsxs)(t.p,{children:["Here DoSomething and DoSomething else are generated as specified by the template CalculateElapsedTime.\nCopycat has convention to replace delegate invocation with decorated method invocation (includes passing all parameters). For convenience, ",(0,s.jsx)(t.em,{children:"nameof(delegate)"})," also replaced with nameof(MethodName) for easier use in templating."]}),(0,s.jsx)(t.h3,{id:"retries",children:"Retries"}),(0,s.jsx)(t.p,{children:"Let's make our generator do some more interesting task. In most situations Polly nuget package is the best choice for retries. But for simple cases it may bring unnecessary complexity, like here:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:'public interface ICache<T>\n{\n    Task<T> Get(string key);\n    Task<T> Set(string key, T value);\n}\n\n[Decorate]\npublic partial class CacheDecorator<T> : ICache<T>\n{\n    private readonly ICache<T> _decorated;\n    \n    public CacheDecorator(ICache<T> decorated) => _decorated = decorated;\n    \n    [Template]\n    public async Task<T> RetryOnce(Func<Task<T>> action, string key)\n    {\n        try\n        {\n            return await action();\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"Retry {nameof(action)} for {key} due to {e.Message}");\n            return await action();\n        }\n    }\n}\n\npublic partial class CacheDecorator<T>\n{\n    /// <see cref = "CacheDecorator.RetryOnce(Func{Task{T}}, string)"/>\n    public async Task<T> Get(string key)\n    {\n        try\n        {\n            return await _decorated.Get(key);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"Retry {nameof(Get)} for {key} due to {e.Message}");\n            return await _decorated.Get(key);\n        }\n    }\n\n    /// <see cref = "CacheDecorator.RetryOnce(Func{Task{T}}, string)"/>\n    public async Task<T> Set(string key, T value)\n    {\n        try\n        {\n            return await _decorated.Set(key, value);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"Retry {nameof(Set)} for {key} due to {e.Message}");\n            return await _decorated.Set(key, value);\n        }\n    }\n}\n'})}),(0,s.jsxs)(t.p,{children:["Caching should be fast, so we can't retry many times. One is ok, especially with some log message about the problem.\nPay attention to ",(0,s.jsx)(t.em,{children:"key"})," parameter in the template, it matches nicely our interface methods parameter."]}),(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"If additional parameters defined in template, then generator applies this template only for methods that have same exact parameter.\nActually, we can implement more complext retry patterns, too:"}),"\n"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-C#",children:'[Template]\npublic async Task<T> Retry<T>(Func<Task<T>> action)\n{\n    var retryCount = 0;\n    while (true)\n    {\n        try\n        {\n            return await action();\n        }\n        catch (Exception e)\n        {\n            if (retryCount++ >= 3)\n                throw;\n            Console.WriteLine($"Retry {nameof(action)} {retryCount} due to {e.Message}");\n        }\n    }\n}\n'})}),(0,s.jsx)(t.h3,{id:"advanced",children:"Advanced"}),(0,s.jsxs)(t.p,{children:["There are plenty use cases, than can be covered with Copycat. Feel free to explore them in ",(0,s.jsx)(t.code,{children:"src/Copycat/Copycat.IntegrationTests"})," (and ",(0,s.jsx)(t.code,{children:"Generated"})," folder inside).\nFor instance, defining template in base class (see RetryWrapperWithBase.cs) or using multiple template to match methods with different signature see TestMultipleTemplates.cs)."]})]}),"\n",(0,s.jsx)(t.h3,{id:"about",children:"About"}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"Implementation of the Decorator pattern in C# - only for not implemented methods"})}),"\n",(0,s.jsx)(t.h2,{id:"how-to-use",children:"How to use"}),"\n",(0,s.jsx)(t.h3,{id:"example-source-csproj-source-files",children:"Example (source csproj, source files)"}),"\n",(0,s.jsxs)(i.A,{children:[(0,s.jsxs)(r.A,{value:"csproj",label:"CSharp Project",children:[(0,s.jsxs)(t.p,{children:["This is the CSharp Project that references ",(0,s.jsx)(t.strong,{children:"CopyCat"})]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",metastring:"showLineNumbers {11}",children:'<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net8.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include="Copycat" Version="0.2.0-beta.1" OutputItemType="Analyzer"   />\n  </ItemGroup>\n\t<PropertyGroup>\n\t\t<EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>\n\t\t<CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\\GX</CompilerGeneratedFilesOutputPath>\n\t</PropertyGroup>\n</Project>\n\n'})})]}),(0,s.jsxs)(r.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\CopyCat\\src\\CCDemo\\Program.cs",label:"Program.cs",children:[(0,s.jsxs)(t.p,{children:["This is the use of ",(0,s.jsx)(t.strong,{children:"CopyCat"})," in ",(0,s.jsx)(t.em,{children:"Program.cs"})]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:"using CCDemo;\n\nICoffee c =new Coffee();\nc= new CoffeeWithLogging(c);\nawait c.Prepare();\n"})})]}),(0,s.jsxs)(r.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\CopyCat\\src\\CCDemo\\ICoffee.cs",label:"ICoffee.cs",children:[(0,s.jsxs)(t.p,{children:["This is the use of ",(0,s.jsx)(t.strong,{children:"CopyCat"})," in ",(0,s.jsx)(t.em,{children:"ICoffee.cs"})]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:"\nnamespace CCDemo;\n\ninternal interface ICoffee\n{\n    //for the moment does not work for properties in interface\n    //string? Name { get; set; }\n    Task<bool> Prepare();\n\n    string[] GetIngredients();\n}\n"})})]}),(0,s.jsxs)(r.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\CopyCat\\src\\CCDemo\\Coffee.cs",label:"Coffee.cs",children:[(0,s.jsxs)(t.p,{children:["This is the use of ",(0,s.jsx)(t.strong,{children:"CopyCat"})," in ",(0,s.jsx)(t.em,{children:"Coffee.cs"})]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:'namespace CCDemo;\ninternal class Coffee : ICoffee\n{\n    public string? Name { get; set; }\n    public async Task<bool> Prepare()\n    {\n        Console.WriteLine("start prepare coffee");\n        await Task.Delay(1000);\n        Console.WriteLine("finish prepare coffee");\n        return true;\n    }\n    public string[] GetIngredients() => new[] { "water", "coffee" };\n\n}\n\n'})})]}),(0,s.jsxs)(r.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\CopyCat\\src\\CCDemo\\CoffeeWithLogging.cs",label:"CoffeeWithLogging.cs",children:[(0,s.jsxs)(t.p,{children:["This is the use of ",(0,s.jsx)(t.strong,{children:"CopyCat"})," in ",(0,s.jsx)(t.em,{children:"CoffeeWithLogging.cs"})]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:'using Copycat;\n\nnamespace CCDemo;\n[Decorate]\ninternal partial class CoffeeWithLogging: ICoffee\n{\n    [Template]\n    private string[] AddLogging(Func<string[]> action)\n    {\n        try\n        {\n            Console.WriteLine($"start logging {nameof(action)}  ");\n            return action();\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"exception  {nameof(action)} ");\n            throw;\n        }\n        finally\n        {\n               Console.WriteLine($"end logging {nameof(action)} ");\n        }\n    }\n\n\n    [Template]\n    public async Task<bool> AddLogging(Func<Task<bool>> action)       \n    {\n        try\n        {\n            Console.WriteLine($"start logging {nameof(action)} ");\n            return await action();\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"exception  {nameof(action)} ");\n            throw;\n        }\n        finally\n        {\n            Console.WriteLine($"end logging {nameof(action)} ");\n        }\n    }\n}\n\n'})})]})]}),"\n",(0,s.jsx)(t.h3,{id:"generated-files",children:"Generated Files"}),"\n",(0,s.jsx)(t.p,{children:"Those are taken from $(BaseIntermediateOutputPath)\\GX"}),"\n",(0,s.jsx)(i.A,{children:(0,s.jsx)(r.A,{value:"D:\\gth\\RSCG_Examples\\v2\\rscg_examples\\CopyCat\\src\\CCDemo\\obj\\GX\\Copycat\\Copycat.DecoratorGenerator\\CoffeeWithLogging.g.cs",label:"CoffeeWithLogging.g.cs",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers ",children:'// <auto-generated/>\nusing Copycat;\n\nnamespace CCDemo;\ninternal partial class CoffeeWithLogging\n{\n    private CCDemo.ICoffee _decorated;\n    public CoffeeWithLogging(CCDemo.ICoffee decorated)\n    {\n        _decorated = decorated;\n    }\n\n    /// <see cref = "CoffeeWithLogging.AddLogging(Func{Task{bool}})"/>\n    public async //for the moment does not work for properties in interface\n    //string? Name { get; set; }\n    Task<bool> Prepare()\n    {\n        try\n        {\n            Console.WriteLine($"start logging {nameof(Prepare)} ");\n            return await _decorated.Prepare();\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"exception  {nameof(Prepare)} ");\n            throw;\n        }\n        finally\n        {\n            Console.WriteLine($"end logging {nameof(Prepare)} ");\n        }\n    }\n\n    /// <see cref = "CoffeeWithLogging.AddLogging(Func{string[]})"/>\n    public string[] GetIngredients()\n    {\n        try\n        {\n            Console.WriteLine($"start logging {nameof(GetIngredients)}  ");\n            return _decorated.GetIngredients();\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"exception  {nameof(GetIngredients)} ");\n            throw;\n        }\n        finally\n        {\n            Console.WriteLine($"end logging {nameof(GetIngredients)} ");\n        }\n    }\n}\n'})})})}),"\n",(0,s.jsx)(t.h2,{id:"useful",children:"Useful"}),"\n",(0,s.jsx)(t.h3,{id:"download-example-net--c",children:"Download Example (.NET  C#)"}),"\n",(0,s.jsx)(t.admonition,{type:"tip",children:(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(84795).A+"",children:"Download Example project CopyCat "})})}),"\n",(0,s.jsx)(t.h3,{id:"share-copycat",children:"Share CopyCat"}),"\n",(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat&quote=CopyCat",title:"Share on Facebook",target:"_blank",children:"Share on Facebook"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"https://twitter.com/intent/tweet?source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat&text=CopyCat:%20https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat",target:"_blank",title:"Tweet",children:"Share in Twitter"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"http://www.reddit.com/submit?url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat&title=CopyCat",target:"_blank",title:"Submit to Reddit",children:"Share on Reddit"})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat&title=CopyCat&summary=&source=https%3A%2F%2Fignatandrei.github.io%2FRSCG_Examples%2Fv2%2Fdocs%2FCopyCat",target:"_blank",title:"Share on LinkedIn",children:"Share on Linkedin"})})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/CopyCat",children:"https://ignatandrei.github.io/RSCG_Examples/v2/docs/CopyCat"})}),"\n",(0,s.jsx)(t.p,{children:"aaa"}),"\n",(0,s.jsx)(l.Ay,{})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},84795:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/files/CopyCat-cb5521fb4dbcc731d40cb33aeb1f9eb9.zip"}}]);